<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4. API reference &mdash; hymd 1.0.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css?v=995e94df" />
      <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.min.css?v=21c0b90a" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=9ae11f4d" />

  
    <link rel="shortcut icon" href="../_static/hymd_icon_white.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=64a571bd"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="3. Benchmarks" href="benchmarks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/hymd_logl_white_text_abbr.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#dependencies">1.1. Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-hymd">1.2. Installing HyMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#install-in-docker">1.3. Install in docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#run-interactively-in-google-colaboratory">1.4. Run interactively in Google Colaboratory</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#common-issues">1.5. Common issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#numpy-errors-while-importing-the-fortran-force-kernels">1.5.1. Numpy errors while importing the Fortran force kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#error-building-pfft-python-due-to-missing-curl-wget">1.5.2. Error building pfft-python due to missing curl/wget</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#error-running-parallel-hymd-without-mpi-enabled-h5py">1.5.3. Error running parallel HyMD without MPI-enabled h5py</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">2. Usage overview for HylleraasMD</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#running-parallel-simulations">2.1. Running parallel simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#running-tests">2.2. Running tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config_file.html">3. Configuration file</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config_file.html#configuration-file-keywords">3.1. Configuration file keywords</a><ul>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#metadata-keywords">3.1.1. Metadata keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#particle-keywords">3.1.2. Particle keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#simulation-keywords">3.1.3. Simulation keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#field-keywords">3.1.4. Field keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#bond-keywords">3.1.5. Bond keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#electrostatic-keywords">3.1.6. Electrostatic keywords</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="topology_input.html">4. Topology and structure file</a><ul>
<li class="toctree-l2"><a class="reference internal" href="topology_input.html#required-datasets">4.1. Required datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="topology_input.html#optional-datasets">4.2. Optional datasets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">5. Command line arguments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="command_line.html#required-arguments">5.1. Required arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="command_line.html#optional-arguments">5.2. Optional arguments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="constants_and_units.html">6. Constants and Units</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples.html">1. Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples.html#ideal-gas">1.1. Ideal gas</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#ideal-chains">1.2. Ideal chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#stiff-rods">1.3. Stiff rods</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#helixes">1.4. Helixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#phase-separation">1.5. Phase separation</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#diblock-copolymers">1.6. Diblock copolymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#lipid-bilayer-self-assembly">1.7. Lipid bilayer self-assembly</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#peptide-in-lipid-bilayer">1.8. Peptide in lipid bilayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#sds">1.9. SDS</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="theory.html">1. Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="theory.html#external-potential">1.1. External potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#force-interpolation">1.2. Force interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#reciprocal-space-calculations">1.3. Reciprocal space calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#filter">1.4. Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#hamiltonian-form">1.5. Hamiltonian form</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intramolecular_bonds.html">2. Intramolecular bonds</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intramolecular_bonds.html#two-particle-bonds">2.1. Two-particle bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="intramolecular_bonds.html#three-particle-bonds">2.2. Three-particle bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="intramolecular_bonds.html#four-particle-bonds">2.3. Four-particle bonds</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="electrostatics.html">3. Electrostatic interactions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="electrostatics.html#specifying-electrostatics">3.1. Specifying electrostatics</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="interaction_energy_functionals.html">1. Interaction energy functionals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interaction_energy_functionals.html#chi-interaction-and-kappa-incompressibility">1.1. <span class="math notranslate nohighlight">\(\chi\)</span>–interaction and <span class="math notranslate nohighlight">\(\kappa\)</span>–incompressibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="interaction_energy_functionals.html#only-kappa-incompressibility">1.2. Only <span class="math notranslate nohighlight">\(\kappa\)</span>–incompressibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="interaction_energy_functionals.html#only-phi-2">1.3. Only <span class="math notranslate nohighlight">\(\phi^2\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="interaction_energy_functionals.html#implementing-new-interaction-energy-forms">1.4. Implementing new interaction energy forms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="filtering.html">2. Filtering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="filtering.html#implementing-new-filters">2.1. Implementing new filters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">3. Benchmarks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="benchmarks.html#bonded-forces">3.1. Bonded forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmarks.html#particle-field-forces">3.2. Particle–field forces</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-hymd.integrator">4.1. Integrator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hymd.integrator.integrate_position"><code class="docutils literal notranslate"><span class="pre">integrate_position()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.integrator.integrate_velocity"><code class="docutils literal notranslate"><span class="pre">integrate_velocity()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hymd.thermostat">4.2. Thermostat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hymd.thermostat._random_chi_squared"><code class="docutils literal notranslate"><span class="pre">_random_chi_squared()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.thermostat._random_gaussian"><code class="docutils literal notranslate"><span class="pre">_random_gaussian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.thermostat.csvr_thermostat"><code class="docutils literal notranslate"><span class="pre">csvr_thermostat()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hamiltonian">4.3. Hamiltonian</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hymd.hamiltonian.Hamiltonian"><code class="docutils literal notranslate"><span class="pre">Hamiltonian</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.hamiltonian.Hamiltonian.__init__"><code class="docutils literal notranslate"><span class="pre">Hamiltonian.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.hamiltonian.Hamiltonian._setup"><code class="docutils literal notranslate"><span class="pre">Hamiltonian._setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.hamiltonian.SquaredPhi"><code class="docutils literal notranslate"><span class="pre">SquaredPhi</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.hamiltonian.SquaredPhi.__init__"><code class="docutils literal notranslate"><span class="pre">SquaredPhi.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.hamiltonian.SquaredPhi.setup"><code class="docutils literal notranslate"><span class="pre">SquaredPhi.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.hamiltonian.DefaultNoChi"><code class="docutils literal notranslate"><span class="pre">DefaultNoChi</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.hamiltonian.DefaultNoChi.__init__"><code class="docutils literal notranslate"><span class="pre">DefaultNoChi.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.hamiltonian.DefaultNoChi.setup"><code class="docutils literal notranslate"><span class="pre">DefaultNoChi.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.hamiltonian.DefaultWithChi"><code class="docutils literal notranslate"><span class="pre">DefaultWithChi</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.hamiltonian.DefaultWithChi.__init__"><code class="docutils literal notranslate"><span class="pre">DefaultWithChi.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.hamiltonian.DefaultWithChi.setup"><code class="docutils literal notranslate"><span class="pre">DefaultWithChi.setup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hymd.force">4.4. Force</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.Angle"><code class="docutils literal notranslate"><span class="pre">Angle</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Angle.atom_3"><code class="docutils literal notranslate"><span class="pre">Angle.atom_3</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.Bond"><code class="docutils literal notranslate"><span class="pre">Bond</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Bond.atom_1"><code class="docutils literal notranslate"><span class="pre">Bond.atom_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Bond.atom_2"><code class="docutils literal notranslate"><span class="pre">Bond.atom_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Bond.equilibrium"><code class="docutils literal notranslate"><span class="pre">Bond.equilibrium</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Bond.strength"><code class="docutils literal notranslate"><span class="pre">Bond.strength</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.Chi"><code class="docutils literal notranslate"><span class="pre">Chi</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Chi.atom_1"><code class="docutils literal notranslate"><span class="pre">Chi.atom_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Chi.atom_2"><code class="docutils literal notranslate"><span class="pre">Chi.atom_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Chi.interaction_energy"><code class="docutils literal notranslate"><span class="pre">Chi.interaction_energy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.Dielectric_type"><code class="docutils literal notranslate"><span class="pre">Dielectric_type</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Dielectric_type.atom_1"><code class="docutils literal notranslate"><span class="pre">Dielectric_type.atom_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Dielectric_type.dielectric_value"><code class="docutils literal notranslate"><span class="pre">Dielectric_type.dielectric_value</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.Dihedral"><code class="docutils literal notranslate"><span class="pre">Dihedral</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Dihedral.atom_1"><code class="docutils literal notranslate"><span class="pre">Dihedral.atom_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Dihedral.atom_2"><code class="docutils literal notranslate"><span class="pre">Dihedral.atom_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Dihedral.atom_3"><code class="docutils literal notranslate"><span class="pre">Dihedral.atom_3</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Dihedral.atom_4"><code class="docutils literal notranslate"><span class="pre">Dihedral.atom_4</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Dihedral.coeffs"><code class="docutils literal notranslate"><span class="pre">Dihedral.coeffs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.force.Dihedral.dih_type"><code class="docutils literal notranslate"><span class="pre">Dihedral.dih_type</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.compute_angle_forces__plain"><code class="docutils literal notranslate"><span class="pre">compute_angle_forces__plain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.compute_bond_forces__plain"><code class="docutils literal notranslate"><span class="pre">compute_bond_forces__plain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.compute_dihedral_forces__plain"><code class="docutils literal notranslate"><span class="pre">compute_dihedral_forces__plain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.dipole_forces_redistribution"><code class="docutils literal notranslate"><span class="pre">dipole_forces_redistribution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.find_all_paths"><code class="docutils literal notranslate"><span class="pre">find_all_paths()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.prepare_bonds"><code class="docutils literal notranslate"><span class="pre">prepare_bonds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.prepare_bonds_old"><code class="docutils literal notranslate"><span class="pre">prepare_bonds_old()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.prepare_index_based_bonds"><code class="docutils literal notranslate"><span class="pre">prepare_index_based_bonds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.force.propensity_potential_coeffs"><code class="docutils literal notranslate"><span class="pre">propensity_potential_coeffs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#logger">4.5. Logger</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hymd.logger.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.logger.Logger.setup"><code class="docutils literal notranslate"><span class="pre">Logger.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.logger.MPIFilterRoot"><code class="docutils literal notranslate"><span class="pre">MPIFilterRoot</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.logger.MPIFilterRoot.filter"><code class="docutils literal notranslate"><span class="pre">MPIFilterRoot.filter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.logger.MPIFilterAll"><code class="docutils literal notranslate"><span class="pre">MPIFilterAll</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.logger.MPIFilterAll.filter"><code class="docutils literal notranslate"><span class="pre">MPIFilterAll.filter()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hymd.input_parser">4.6. Input parser</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.Config"><code class="docutils literal notranslate"><span class="pre">Config</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.a"><code class="docutils literal notranslate"><span class="pre">Config.a</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.angle_bonds"><code class="docutils literal notranslate"><span class="pre">Config.angle_bonds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.barostat"><code class="docutils literal notranslate"><span class="pre">Config.barostat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.barostat_type"><code class="docutils literal notranslate"><span class="pre">Config.barostat_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.bonds"><code class="docutils literal notranslate"><span class="pre">Config.bonds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.box_size"><code class="docutils literal notranslate"><span class="pre">Config.box_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.cancel_com_momentum"><code class="docutils literal notranslate"><span class="pre">Config.cancel_com_momentum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.chi"><code class="docutils literal notranslate"><span class="pre">Config.chi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.conv_crit"><code class="docutils literal notranslate"><span class="pre">Config.conv_crit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.convergence_type"><code class="docutils literal notranslate"><span class="pre">Config.convergence_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.coulomb_constant"><code class="docutils literal notranslate"><span class="pre">Config.coulomb_constant</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.coulombtype"><code class="docutils literal notranslate"><span class="pre">Config.coulombtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.dielectric_const"><code class="docutils literal notranslate"><span class="pre">Config.dielectric_const</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.dielectric_type"><code class="docutils literal notranslate"><span class="pre">Config.dielectric_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.dihedrals"><code class="docutils literal notranslate"><span class="pre">Config.dihedrals</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.domain_decomposition"><code class="docutils literal notranslate"><span class="pre">Config.domain_decomposition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.dtype"><code class="docutils literal notranslate"><span class="pre">Config.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.file_name"><code class="docutils literal notranslate"><span class="pre">Config.file_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.gas_constant"><code class="docutils literal notranslate"><span class="pre">Config.gas_constant</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.hamiltonian"><code class="docutils literal notranslate"><span class="pre">Config.hamiltonian</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.initial_energy"><code class="docutils literal notranslate"><span class="pre">Config.initial_energy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.integrator"><code class="docutils literal notranslate"><span class="pre">Config.integrator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.kappa"><code class="docutils literal notranslate"><span class="pre">Config.kappa</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.m"><code class="docutils literal notranslate"><span class="pre">Config.m</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.mass"><code class="docutils literal notranslate"><span class="pre">Config.mass</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.max_molecule_size"><code class="docutils literal notranslate"><span class="pre">Config.max_molecule_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.mesh_size"><code class="docutils literal notranslate"><span class="pre">Config.mesh_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.n_b"><code class="docutils literal notranslate"><span class="pre">Config.n_b</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.n_flush"><code class="docutils literal notranslate"><span class="pre">Config.n_flush</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.n_particles"><code class="docutils literal notranslate"><span class="pre">Config.n_particles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.n_print"><code class="docutils literal notranslate"><span class="pre">Config.n_print</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.n_steps"><code class="docutils literal notranslate"><span class="pre">Config.n_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.name"><code class="docutils literal notranslate"><span class="pre">Config.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.pol_mixing"><code class="docutils literal notranslate"><span class="pre">Config.pol_mixing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.pressure"><code class="docutils literal notranslate"><span class="pre">Config.pressure</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.respa_inner"><code class="docutils literal notranslate"><span class="pre">Config.respa_inner</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.rho0"><code class="docutils literal notranslate"><span class="pre">Config.rho0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.self_energy"><code class="docutils literal notranslate"><span class="pre">Config.self_energy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.sigma"><code class="docutils literal notranslate"><span class="pre">Config.sigma</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.start_temperature"><code class="docutils literal notranslate"><span class="pre">Config.start_temperature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.tags"><code class="docutils literal notranslate"><span class="pre">Config.tags</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.target_pressure"><code class="docutils literal notranslate"><span class="pre">Config.target_pressure</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.target_temperature"><code class="docutils literal notranslate"><span class="pre">Config.target_temperature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.tau"><code class="docutils literal notranslate"><span class="pre">Config.tau</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.tau_p"><code class="docutils literal notranslate"><span class="pre">Config.tau_p</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.thermostat_coupling_groups"><code class="docutils literal notranslate"><span class="pre">Config.thermostat_coupling_groups</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.thermostat_work"><code class="docutils literal notranslate"><span class="pre">Config.thermostat_work</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.time_step"><code class="docutils literal notranslate"><span class="pre">Config.time_step</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.input_parser.Config.type_charges"><code class="docutils literal notranslate"><span class="pre">Config.type_charges</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_NPT_conditions"><code class="docutils literal notranslate"><span class="pre">check_NPT_conditions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_angles"><code class="docutils literal notranslate"><span class="pre">check_angles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_bonds"><code class="docutils literal notranslate"><span class="pre">check_bonds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_box_size"><code class="docutils literal notranslate"><span class="pre">check_box_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_cancel_com_momentum"><code class="docutils literal notranslate"><span class="pre">check_cancel_com_momentum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_charges"><code class="docutils literal notranslate"><span class="pre">check_charges()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_charges_types_list"><code class="docutils literal notranslate"><span class="pre">check_charges_types_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_chi"><code class="docutils literal notranslate"><span class="pre">check_chi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_config"><code class="docutils literal notranslate"><span class="pre">check_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_dielectric"><code class="docutils literal notranslate"><span class="pre">check_dielectric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_dihedrals"><code class="docutils literal notranslate"><span class="pre">check_dihedrals()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_domain_decomposition"><code class="docutils literal notranslate"><span class="pre">check_domain_decomposition()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_hamiltonian"><code class="docutils literal notranslate"><span class="pre">check_hamiltonian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_integrator"><code class="docutils literal notranslate"><span class="pre">check_integrator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_m"><code class="docutils literal notranslate"><span class="pre">check_m()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_mass"><code class="docutils literal notranslate"><span class="pre">check_mass()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_max_molecule_size"><code class="docutils literal notranslate"><span class="pre">check_max_molecule_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_n_b"><code class="docutils literal notranslate"><span class="pre">check_n_b()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_n_flush"><code class="docutils literal notranslate"><span class="pre">check_n_flush()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_n_particles"><code class="docutils literal notranslate"><span class="pre">check_n_particles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_n_print"><code class="docutils literal notranslate"><span class="pre">check_n_print()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_name"><code class="docutils literal notranslate"><span class="pre">check_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_start_and_target_temperature"><code class="docutils literal notranslate"><span class="pre">check_start_and_target_temperature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_tau"><code class="docutils literal notranslate"><span class="pre">check_tau()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.check_thermostat_coupling_groups"><code class="docutils literal notranslate"><span class="pre">check_thermostat_coupling_groups()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.parse_config_toml"><code class="docutils literal notranslate"><span class="pre">parse_config_toml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.read_config_toml"><code class="docutils literal notranslate"><span class="pre">read_config_toml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.input_parser.sort_dielectric_by_type_id"><code class="docutils literal notranslate"><span class="pre">sort_dielectric_by_type_id()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hymd.field">4.7. Field</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hymd.field.compute_field_and_kinetic_energy"><code class="docutils literal notranslate"><span class="pre">compute_field_and_kinetic_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.field.compute_field_energy_q_GPE"><code class="docutils literal notranslate"><span class="pre">compute_field_energy_q_GPE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.field.compute_field_force"><code class="docutils literal notranslate"><span class="pre">compute_field_force()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.field.compute_self_energy_q"><code class="docutils literal notranslate"><span class="pre">compute_self_energy_q()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.field.domain_decomposition"><code class="docutils literal notranslate"><span class="pre">domain_decomposition()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.field.initialize_pm"><code class="docutils literal notranslate"><span class="pre">initialize_pm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.field.update_field"><code class="docutils literal notranslate"><span class="pre">update_field()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.field.update_field_force_q"><code class="docutils literal notranslate"><span class="pre">update_field_force_q()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.field.update_field_force_q_GPE"><code class="docutils literal notranslate"><span class="pre">update_field_force_q_GPE()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hymd.file_io">4.8. File input/output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hymd.file_io.OutDataset"><code class="docutils literal notranslate"><span class="pre">OutDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hymd.file_io.OutDataset.close_file"><code class="docutils literal notranslate"><span class="pre">OutDataset.close_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.file_io.OutDataset.flush"><code class="docutils literal notranslate"><span class="pre">OutDataset.flush()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hymd.file_io.OutDataset.is_open"><code class="docutils literal notranslate"><span class="pre">OutDataset.is_open()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.file_io.distribute_input"><code class="docutils literal notranslate"><span class="pre">distribute_input()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.file_io.setup_time_dependent_element"><code class="docutils literal notranslate"><span class="pre">setup_time_dependent_element()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.file_io.store_data"><code class="docutils literal notranslate"><span class="pre">store_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hymd.file_io.store_static"><code class="docutils literal notranslate"><span class="pre">store_static()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


    
        <p class="caption">
            <span class="caption-text">
            
                Links
            
            </span>
        </p>
        <ul>
            
                
                    <li class="toctree-l1"><a href="https://pypi.org/project/hymd"><i class="fa fa-cube fa-fw"></i> PyPI</a></li>
                
            
                
                    <li class="toctree-l1"><a href="https://github.com/Cascella-Group-UiO/hymd"><i class="fa fa-code fa-fw"></i> Source code</a></li>
                
            
                
                    <li class="toctree-l1"><a href="https://github.com/Cascella-Group-UiO/hymd/issues/"><i class="fa fa-bug fa-fw"></i> Issue tracker</a></li>
                
            
                
                    <li class="toctree-l1"><a href="about:blank"><i class="fa fa-file-text fa-fw"></i> Citation</a></li>
                
            
        </ul>
    


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hymd</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">4. </span>API reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/doc_pages/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<span id="api-label"></span><h1><span class="section-number">4. </span>API reference<a class="headerlink" href="#api-reference" title="Permalink to this heading"></a></h1>
<section id="module-hymd.integrator">
<span id="integrator"></span><h2><span class="section-number">4.1. </span>Integrator<a class="headerlink" href="#module-hymd.integrator" title="Permalink to this heading"></a></h2>
<p>Integrates equations of motion.</p>
<p>Implements the Velocity Verlet integrator. The <em>reversible reference system
propagator algorithm</em> (rRESPA) integrator uses the Velocity Verlet functions
inside the MD loop in the main module.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hymd.integrator.integrate_position">
<span class="sig-prename descclassname"><span class="pre">hymd.integrator.</span></span><span class="sig-name descname"><span class="pre">integrate_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/integrator.html#integrate_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.integrator.integrate_position" title="Permalink to this definition"></a></dt>
<dd><p>Position update step of the Velocity Verlet integration algorithm.</p>
<p>Computes the position update step of the Velocity Verlet algorithm. The
<code class="code docutils literal notranslate"><span class="pre">positions</span></code> argument is <strong>not</strong> changed in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>positions</strong><span class="classifier">(N, D) numpy.ndarray</span></dt><dd><p>Array of positions of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.</p>
</dd>
<dt><strong>velocities</strong><span class="classifier">(N, D) numpy.ndarray</span></dt><dd><p>Array of velocities of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.</p>
</dd>
<dt><strong>time_step</strong><span class="classifier">float</span></dt><dd><p>The time step used in the integration.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.integrator.integrate_velocity" title="hymd.integrator.integrate_velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">integrate_velocity</span></code></a></dt><dd><p>The velocity update step of the Velocity Verlet algorithm.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Velocity Verlet algorithm contains two steps, first the velocties are
integrated one half step forward in time by applying the forces from the
previous step, then the positions are updated a full step using the updated
velocities</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}_{\text{new}} = \mathbf{x} + \Delta t \mathbf{v}\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.integrator.integrate_velocity">
<span class="sig-prename descclassname"><span class="pre">hymd.integrator.</span></span><span class="sig-name descname"><span class="pre">integrate_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">velocities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accelerations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/integrator.html#integrate_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.integrator.integrate_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Velocity update step of the Velocity Verlet integration algorithm.</p>
<p>Computes the velocity update step of the Velocity Verlet algorithm. The
<code class="code docutils literal notranslate"><span class="pre">velocities</span></code> argument is <strong>not</strong> changed in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>velocities</strong><span class="classifier">(N, D) numpy.ndarray</span></dt><dd><p>Array of velocities of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.</p>
</dd>
<dt><strong>accelerations</strong><span class="classifier">(N, D) numpy.ndarray</span></dt><dd><p>Array of accelerations of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.</p>
</dd>
<dt><strong>time_step</strong><span class="classifier">float</span></dt><dd><p>The time step used in the integration.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.integrator.integrate_position" title="hymd.integrator.integrate_position"><code class="xref py py-obj docutils literal notranslate"><span class="pre">integrate_position</span></code></a></dt><dd><p>The position update step of the Velocity Verlet algorithm.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Velocity Verlet algorithm contains two steps, first the velocties are
integrated one half step forward in time by applying the forces from the
previous step</p>
<div class="math notranslate nohighlight">
\[\mathbf{v}_{\text{new}} = \mathbf{v} + \frac{\Delta t}{2m}
\mathbf{f}\]</div>
<p>before the positions are moved a full step using the updated half-step
velocities.</p>
</dd></dl>

</section>
<section id="module-hymd.thermostat">
<span id="thermostat"></span><h2><span class="section-number">4.2. </span>Thermostat<a class="headerlink" href="#module-hymd.thermostat" title="Permalink to this heading"></a></h2>
<p>Scales or otherwise modifies the particle velocities during simulation to
simulate coupling to an external heat bath with temperature T₀.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hymd.thermostat._random_chi_squared">
<span class="sig-prename descclassname"><span class="pre">hymd.thermostat.</span></span><span class="sig-name descname"><span class="pre">_random_chi_squared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/hymd/thermostat.html#_random_chi_squared"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.thermostat._random_chi_squared" title="Permalink to this definition"></a></dt>
<dd><p>Draw the sum of <code class="code docutils literal notranslate"><span class="pre">M</span></code> squared normally distributed values</p>
<p>The value is generated by the Gamma distribution, in lieu of generating
<code class="code docutils literal notranslate"><span class="pre">M</span></code> Gaussian distributed numbers and summing their squares.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>prng</strong><span class="classifier">np.random.Generator</span></dt><dd><p>Numpy object that provides a stream of random bits</p>
</dd>
<dt><strong>M</strong><span class="classifier">int</span></dt><dd><p>Number of standard normally distributed numbers in the sum.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd><p>The sum of <code class="code docutils literal notranslate"><span class="pre">M</span></code> squared normally distributed values centered at
zero with unit standard deviation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The sum of the squares of k independent standard normal random variables is
distributed according to a <span class="math notranslate nohighlight">\(\chi^2\)</span> distribution.</p>
<div class="math notranslate nohighlight">
\[\chi^2_1 + \chi_2^2 + \chi_3^2 + \dots + \chi_M^2
\sim
\sigma^2\chi^2(k)\]</div>
<p>This is a special case of the <span class="math notranslate nohighlight">\(\Gamma\)</span> distribution,
<span class="math notranslate nohighlight">\(\Gamma(k/2, 2)\)</span>, and may be generated by</p>
<div class="math notranslate nohighlight">
\[\chi^2(k) \sim 2 \Gamma(k/2, 2)\]</div>
<p class="rubric">References</p>
<p>Knuth, D.E. 1981, Seminumerical Algorithms, 2nd ed., vol. 2 of The Art of
Computer Programming (Reading, MA: Addison-Wesley), pp. 120ff.
J. H. Ahrens and U. Dieter, Computing 12 (1974), 223-246.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.thermostat._random_gaussian">
<span class="sig-prename descclassname"><span class="pre">hymd.thermostat.</span></span><span class="sig-name descname"><span class="pre">_random_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/hymd/thermostat.html#_random_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.thermostat._random_gaussian" title="Permalink to this definition"></a></dt>
<dd><p>Draw a single random number from the standard normal distribution
Generate a number from the Gaussian distribution centered at zero with unit
standard deviation, <span class="math notranslate nohighlight">\(N(0, 1)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>prng</strong><span class="classifier">np.random.Generator</span></dt><dd><p>Numpy object that provides a stream of random bits</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd><p>A random number drawn from <span class="math notranslate nohighlight">\(N(0, 1)\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.thermostat.csvr_thermostat">
<span class="sig-prename descclassname"><span class="pre">hymd.thermostat.</span></span><span class="sig-name descname"><span class="pre">csvr_thermostat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">velocity:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">names:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">config:</span> <span class="pre">~hymd.input_parser.Config,</span> <span class="pre">prng:</span> <span class="pre">~numpy.random._generator.Generator,</span> <span class="pre">comm:</span> <span class="pre">~mpi4py.MPI.Intracomm</span> <span class="pre">=</span> <span class="pre">&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;,</span> <span class="pre">random_gaussian:</span> <span class="pre">~typing.Callable[[~numpy.random._generator.Generator],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">_random_gaussian&gt;,</span> <span class="pre">random_chi_squared:</span> <span class="pre">~typing.Callable[[~numpy.random._generator.Generator,</span> <span class="pre">int,</span> <span class="pre">float],</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">_random_chi_squared&gt;,</span> <span class="pre">remove_center_of_mass_momentum:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/hymd/thermostat.html#csvr_thermostat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.thermostat.csvr_thermostat" title="Permalink to this definition"></a></dt>
<dd><p>Canonical sampling through velocity rescaling thermostat</p>
<p>Implements the CSVR thermostat. Rescales the system kinetic energy by a
stochastically chosen factor to keep the temperature constant. Requires
communcation of the kinetic energies calculated locally for each MPI rank.
The random numbers sampled through <code class="code docutils literal notranslate"><span class="pre">random_gaussian</span></code> and
<code class="code docutils literal notranslate"><span class="pre">random_chi_squared</span></code> are broadcast from the root rank to the other
ranks to ensure the scaling is performed with the same stochasticity for
all particles in the full system.</p>
<p>The velocities are cleaned of center of mass momentum before the thermostat
is applied, and the center of mass momentum is subsequently reapplied. This
is performed for each thermostat coupling group, i.e. the center of mass
momenta of each <em>group</em> is separately removed and reapplied after
thermostatting.</p>
<p>The implementation here is based on the derivation presented in the 2008
Comput. Phys. Commun paper, not in the original 2007 J. Chem. Phys. paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>velocity</strong><span class="classifier">(N, D) numpy.ndarray</span></dt><dd><p>Array of velocities of N particles in D dimensions.</p>
</dd>
<dt><strong>names</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of particle names.</p>
</dd>
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration dataclass containing simulation metadata and parameters.</p>
</dd>
<dt><strong>prng</strong><span class="classifier">np.random.Generator</span></dt><dd><p>Numpy object that provides a stream of random bits</p>
</dd>
<dt><strong>comm</strong><span class="classifier">MPI.Intracomm, optional</span></dt><dd><p>MPI communicator to use for rank commuication. Defaults to
MPI.COMM_WORLD.</p>
</dd>
<dt><strong>random_gaussian</strong><span class="classifier">callable, optional</span></dt><dd><p>Function for generating standard normally distributed numbers.</p>
</dd>
<dt><strong>random_chi_squared</strong><span class="classifier">callable, optional</span></dt><dd><p>Function for generating <span class="math notranslate nohighlight">\(\chi^2\)</span>-distributed numbers</p>
</dd>
<dt><strong>remove_center_of_mass_momentum</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, the center of mass of each coupling group is removed before
the thermostat is applied. The center of mass momenta are added back
after the kinetic energy rescaling is complete.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.thermostat._random_gaussian" title="hymd.thermostat._random_gaussian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_random_gaussian</span></code></a></dt><dd><p>Used to sample Gaussian-distributed numbers.</p>
</dd>
<dt><a class="reference internal" href="#hymd.thermostat._random_chi_squared" title="hymd.thermostat._random_chi_squared"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_random_chi_squared</span></code></a></dt><dd><p>Used to sample <span class="math notranslate nohighlight">\(\chi^2\)</span>-distributed numbers.</p>
</dd>
<dt><a class="reference internal" href="#hymd.input_parser.Config" title="hymd.input_parser.Config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.input_parser.Config</span></code></a></dt><dd><p>Configuration dataclass handler.</p>
</dd>
</dl>
</div>
<p class="rubric">References</p>
<p>G. Bussi, D. Donadio, and M. Parrinello, J. Chem. Phys. 126, 014101 (2007).
G. Bussi and M. Parrinello, Comput. Phys. Commun. 179, 26-29, (2008).</p>
</dd></dl>

</section>
<section id="hamiltonian">
<h2><span class="section-number">4.3. </span>Hamiltonian<a class="headerlink" href="#hamiltonian" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="hymd.hamiltonian.Hamiltonian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.hamiltonian.</span></span><span class="sig-name descname"><span class="pre">Hamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#Hamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.Hamiltonian" title="Permalink to this definition"></a></dt>
<dd><p>Interaction energy functional superclass</p>
<dl class="py method">
<dt class="sig sig-object py" id="hymd.hamiltonian.Hamiltonian.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#Hamiltonian.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.Hamiltonian.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.input_parser.Config" title="hymd.input_parser.Config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.input_parser.Config</span></code></a></dt><dd><p>Configuration dataclass handler.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hymd.hamiltonian.Hamiltonian._setup">
<span class="sig-name descname"><span class="pre">_setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#Hamiltonian._setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.Hamiltonian._setup" title="Permalink to this definition"></a></dt>
<dd><p>Superclass setup</p>
<p>Sets up the grid-independent filtering function <code class="code docutils literal notranslate"><span class="pre">H</span></code>, and the
SymPy logic for symbolically differentiating interaction energy
functionals in Hamiltonian subclasses.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hymd.hamiltonian.SquaredPhi">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.hamiltonian.</span></span><span class="sig-name descname"><span class="pre">SquaredPhi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#SquaredPhi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.SquaredPhi" title="Permalink to this definition"></a></dt>
<dd><p>Simple squared density interaction energy functional</p>
<p>The interaction energy density takes the form</p>
<div class="math notranslate nohighlight">
\[w[\tilde\phi] = \frac{1}{2\kappa\rho_0}
    \left(
        \sum_k \tilde\phi_k
    \right)^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(\kappa\)</span> is the compressibility and <span class="math notranslate nohighlight">\(rho_0\)</span> is the
average density of the fully homogenous system. Expressing the species
densities in terms of fluctuations from the average,</p>
<div class="math notranslate nohighlight">
\[\mathrm{d}\tilde\phi_k = \rho_0 - \tilde\phi_k,\]</div>
<p>it is evident that this interaction energy functional is a slight change of
the <code class="code docutils literal notranslate"><span class="pre">DefaultNoChi</span></code> Hamiltonian, as the expanded interaction energy
density becomes</p>
<div class="math notranslate nohighlight">
\[w[\tilde\phi] = \frac{1}{2\kappa\rho_0}
    \left(
        6\rho_0\left[
            \sum_k \mathrm{d}\tilde\phi_k
        \right]
        +
        9\rho_0^2
        +
        \sum_k \mathrm{d}\tilde\phi_k^2
        +
        \prod_{k\not=l}
            \mathrm{d}\tilde\phi_k \mathrm{d}\tilde\phi_l
    \right),\]</div>
<p>identical to <code class="code docutils literal notranslate"><span class="pre">DefaultNoChi</span></code> apart from a constant energy shift
<span class="math notranslate nohighlight">\(9\rho_0^2`(which does not impact dynamics) and the
:math:\)</span>rho_0`–<span class="math notranslate nohighlight">\(\mathrm{d}\tilde\phi_k\)</span> cross-terms. These
cross-terms constitute contributions to the energy linear in
<span class="math notranslate nohighlight">\(\mathrm{d}\tilde\phi_k\)</span> absent in <code class="code docutils literal notranslate"><span class="pre">DefaultNoChi</span></code>, which has
only quadratic terms present.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.hamiltonian.DefaultNoChi" title="hymd.hamiltonian.DefaultNoChi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.hamiltonian.DefaultNoChi</span></code></a></dt><dd></dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="hymd.hamiltonian.SquaredPhi.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#SquaredPhi.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.SquaredPhi.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.input_parser.Config" title="hymd.input_parser.Config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.input_parser.Config</span></code></a></dt><dd><p>Configuration dataclass handler.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hymd.hamiltonian.SquaredPhi.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#SquaredPhi.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.SquaredPhi.setup" title="Permalink to this definition"></a></dt>
<dd><p>Setup the interaction energy potential and the external potential</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hymd.hamiltonian.DefaultNoChi">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.hamiltonian.</span></span><span class="sig-name descname"><span class="pre">DefaultNoChi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#DefaultNoChi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.DefaultNoChi" title="Permalink to this definition"></a></dt>
<dd><p>Incompressibility-only interaction energy functional</p>
<p>The interaction energy density takes the form</p>
<div class="math notranslate nohighlight">
\[w[\tilde\phi] = \frac{1}{2\kappa} \left(
    \sum_k \tilde\phi_k - a
\right)^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(\kappa\)</span> is the compressibility and <span class="math notranslate nohighlight">\(a=\rho_0\)</span> for
NVT runs where <span class="math notranslate nohighlight">\(\rho_0\)</span> is the average density of the fully
homogenous system. In case of NPT runs, <span class="math notranslate nohighlight">\(a\)</span> is a calibrated
parameter to obtain the correct average density at the target temperature
and pressure. The <code class="code docutils literal notranslate"><span class="pre">SquaredPhi</span></code> Hamiltonian implements a similar
functional with an additional linear term component depending on</p>
<div class="math notranslate nohighlight">
\[\mathmr{d}\tilde\phi_k = \tilde\phi_k - \rho_0\]</div>
<p>and not <span class="math notranslate nohighlight">\(\mathrm{d}\tilde\phi_k^2\)</span>. No explicit inter-species
interaction is present apart from the indirect interaction through the
incompressibility.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.hamiltonian.DefaultNoChi" title="hymd.hamiltonian.DefaultNoChi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.hamiltonian.DefaultNoChi</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#hymd.input_parser.Config" title="hymd.input_parser.Config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.input_parser.Config</span></code></a></dt><dd><p>Configuration dataclass handler.</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="hymd.hamiltonian.DefaultNoChi.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#DefaultNoChi.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.DefaultNoChi.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.input_parser.Config" title="hymd.input_parser.Config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.input_parser.Config</span></code></a></dt><dd><p>Configuration dataclass handler.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hymd.hamiltonian.DefaultNoChi.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#DefaultNoChi.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.DefaultNoChi.setup" title="Permalink to this definition"></a></dt>
<dd><p>Setup the interaction energy potential and the external potential</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hymd.hamiltonian.DefaultWithChi">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.hamiltonian.</span></span><span class="sig-name descname"><span class="pre">DefaultWithChi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_to_name_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#DefaultWithChi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.DefaultWithChi" title="Permalink to this definition"></a></dt>
<dd><p>Incompressibility and <span class="math notranslate nohighlight">\(\chi\)</span>-interactions energy functional</p>
<p>The interaction energy density takes the form</p>
<div class="math notranslate nohighlight">
\[w[\tilde\phi] =
    \frac{1}{2\rho_0}
        \sum_{k,l}\chi_{kl} \tilde\phi_k \tilde\phi_l
    +
    \frac{1}{2\kappa} \left(
        \sum_k \tilde\phi_k - a
    \right)^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(\kappa\)</span> is the compressibility and <span class="math notranslate nohighlight">\(a=\rho_0\)</span> for
NVT runs where <span class="math notranslate nohighlight">\(\rho_0\)</span> is the average density of the fully
homogenous system. In case of NPT runs, <span class="math notranslate nohighlight">\(a\)</span> is a calibrated
parameter to obtain the correct average density at the target temperature
and pressure. <span class="math notranslate nohighlight">\(\chi_{ij}\)</span> is the Flory-Huggins-like
inter-species mixing energy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="hymd.hamiltonian.DefaultWithChi.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_to_name_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#DefaultWithChi.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.DefaultWithChi.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
<dt><strong>unique_names</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Sorted array of all distinct names of different species present in
the simulation. Result of <code class="code docutils literal notranslate"><span class="pre">numpy.unique(all_names)</span></code>, where
<code class="code docutils literal notranslate"><span class="pre">all_names</span></code> is the gathered union of all individual MPI
ranks’ <code class="code docutils literal notranslate"><span class="pre">names</span></code> arrays.</p>
</dd>
<dt><strong>type_to_name_map</strong><span class="classifier">dict[int, str]</span></dt><dd><p>Dictionary of the mapping from type indices (integers) to type
names.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.input_parser.Config" title="hymd.input_parser.Config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.input_parser.Config</span></code></a></dt><dd><p>Configuration dataclass handler.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hymd.hamiltonian.DefaultWithChi.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unique_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_to_name_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/hamiltonian.html#DefaultWithChi.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.hamiltonian.DefaultWithChi.setup" title="Permalink to this definition"></a></dt>
<dd><p>Setup the interaction energy potential and the external potential</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>unique_names</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Sorted array of all distinct names of different species present in
the simulation. Result of <code class="code docutils literal notranslate"><span class="pre">numpy.unique(all_names)</span></code>, where
<code class="code docutils literal notranslate"><span class="pre">all_names</span></code> is the gathered union of all individual MPI
ranks’ <code class="code docutils literal notranslate"><span class="pre">names</span></code> arrays.</p>
</dd>
<dt><strong>type_to_name_map</strong><span class="classifier">dict[int, str]</span></dt><dd><p>Dictionary of the mapping from type indices (integers) to type
names.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-hymd.force">
<span id="force"></span><h2><span class="section-number">4.4. </span>Force<a class="headerlink" href="#module-hymd.force" title="Permalink to this heading"></a></h2>
<p>Calculates intramolecular forces between bonded particles in molecules</p>
<dl class="py class">
<dt class="sig sig-object py" id="hymd.force.Angle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">Angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equilibrium</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#Angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.Angle" title="Permalink to this definition"></a></dt>
<dd><p>Dataclass representing a single three-particle bond type</p>
<p>A <cite>bond type</cite> is a bond strength and equilibrium angle associated with
any three-particle bond between particles of specific types <code class="code docutils literal notranslate"><span class="pre">A</span></code>,
<code class="code docutils literal notranslate"><span class="pre">B</span></code>, and <code class="code docutils literal notranslate"><span class="pre">C</span></code> (where <code class="code docutils literal notranslate"><span class="pre">A</span></code>, <code class="code docutils literal notranslate"><span class="pre">B</span></code>, and <code class="code docutils literal notranslate"><span class="pre">C</span></code> may be
different or the same). Harmonic angular three-particle bonds in HyMD take
the form</p>
<div class="math notranslate nohighlight">
\[V_3(\mathbf{r}_1, \mathbf{r}_2, \mathbf{r}_3) =
    \frac{1}{2}k
    \left(
        \cos^{-1}
        \left[
            \frac{
                (\mathbf{r}_1-\mathbf{r}_2)
                \cdot
                (\mathbf{r}_3-\mathbf{r}_2)
            }
            {
                \vert\mathbf{r}_1-\mathbf{r}_2\vert
                \vert\mathbf{r}_3-\mathbf{r}_2\vert
            }
        \right] - \theta_0
    \right)^2\]</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.force.Bond" title="hymd.force.Bond"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bond</span></code></a></dt><dd><p>Two-particle bond type dataclass</p>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atom_1</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 1.</p>
</dd>
<dt><strong>atom_2</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 2.</p>
</dd>
<dt><strong>atom_3</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 3.</p>
</dd>
<dt><strong>equilibrium</strong><span class="classifier">float</span></dt><dd><p>Equilibrium angle at which the energy associated with the
three-particle angular bond vanishes and the resulting force is zero.</p>
</dd>
<dt><strong>strength</strong><span class="classifier">float</span></dt><dd><p>Harmonic bond strength coefficient.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Angle.atom_3">
<span class="sig-name descname"><span class="pre">atom_3</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#hymd.force.Angle.atom_3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hymd.force.Bond">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">Bond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equilibrium</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#Bond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.Bond" title="Permalink to this definition"></a></dt>
<dd><p>Dataclass representing a single two-particle bond type</p>
<p>A <cite>bond type</cite> is a bond strength and equilibrium distance associated with
any bond between particles of specific types <code class="code docutils literal notranslate"><span class="pre">A</span></code> and <code class="code docutils literal notranslate"><span class="pre">B</span></code>
(where <code class="code docutils literal notranslate"><span class="pre">A</span></code> and <code class="code docutils literal notranslate"><span class="pre">B</span></code> may be the same or different). Harmonic
two-particle bonds in HyMD take the form</p>
<div class="math notranslate nohighlight">
\[V_2(\mathbf{r}_1, \mathbf{r}_2) =
    \frac{1}{2}k
    \left(
        \vert \mathbf{r}_1 - \mathbf{r}_2 \vert - r_0
    \right)^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is the bond strength (spring constant) and <span class="math notranslate nohighlight">\(r_0\)</span> is
the equilibrium bond length (at which the energy is zero).</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atom_1</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 1.</p>
</dd>
<dt><strong>atom_2</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 2.</p>
</dd>
<dt><strong>equilibrium</strong><span class="classifier">float</span></dt><dd><p>Equilibrium distance at which the energy associated with the bond
vanishes and the resulting force is zero.</p>
</dd>
<dt><strong>strength</strong><span class="classifier">float</span></dt><dd><p>Harmonic bond strength coefficient (spring constant).</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Bond.atom_1">
<span class="sig-name descname"><span class="pre">atom_1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#hymd.force.Bond.atom_1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Bond.atom_2">
<span class="sig-name descname"><span class="pre">atom_2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#hymd.force.Bond.atom_2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Bond.equilibrium">
<span class="sig-name descname"><span class="pre">equilibrium</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#hymd.force.Bond.equilibrium" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Bond.strength">
<span class="sig-name descname"><span class="pre">strength</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#hymd.force.Bond.strength" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hymd.force.Chi">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">Chi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction_energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#Chi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.Chi" title="Permalink to this definition"></a></dt>
<dd><p>Dataclass representing a single <span class="math notranslate nohighlight">\(\chi\)</span> mixing interaction type</p>
<p>An <cite>interaction mixing energy type</cite> is a mixing energy associated with
density overlap between species of types <code class="code docutils literal notranslate"><span class="pre">A</span></code> and <code class="code docutils literal notranslate"><span class="pre">B</span></code>
(specified as inputs <code class="code docutils literal notranslate"><span class="pre">atom_1</span></code> and <code class="code docutils literal notranslate"><span class="pre">atom_2</span></code>). A positive mixing
energy promotes phase separation, a negative mixing energy promotes mixing.
The interaction energy density (provided the <code class="code docutils literal notranslate"><span class="pre">DefaultWithChi</span></code>
Hamiltonian is used) takes the form</p>
<div class="math notranslate nohighlight">
\[w[\tilde\phi] = \frac{1}{2\kappa}
    \sum_{k,l}\chi_{k,l} \tilde\phi_k\tilde\phi_l,\]</div>
<p>where <span class="math notranslate nohighlight">\(\chi_{k,l}\)</span> denotes the mixing energy between species
<span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(l\)</span>, with <span class="math notranslate nohighlight">\(\kappa\)</span> being the incompressibility.
The value of the interaction mixing energy parameter may be extracted from
<a class="reference external" href="https://en.wikipedia.org/wiki/Flory%E2%80%93Huggins_solution_theory">Flory-Huggins theory</a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.hamiltonian.DefaultWithChi" title="hymd.hamiltonian.DefaultWithChi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.hamiltonian.DefaultWithChi</span></code></a></dt><dd><p>Interaction energy functional using <span class="math notranslate nohighlight">\(\chi\)</span>-interactions.</p>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atom_1</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 1.</p>
</dd>
<dt><strong>atom_2</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 2.</p>
</dd>
<dt><strong>interaction_energy</strong><span class="classifier">float</span></dt><dd><p>Interaction mixing energy.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Chi.atom_1">
<span class="sig-name descname"><span class="pre">atom_1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#hymd.force.Chi.atom_1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Chi.atom_2">
<span class="sig-name descname"><span class="pre">atom_2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#hymd.force.Chi.atom_2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Chi.interaction_energy">
<span class="sig-name descname"><span class="pre">interaction_energy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#hymd.force.Chi.interaction_energy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hymd.force.Dielectric_type">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">Dielectric_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dielectric_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#Dielectric_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.Dielectric_type" title="Permalink to this definition"></a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Dielectric_type.atom_1">
<span class="sig-name descname"><span class="pre">atom_1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#hymd.force.Dielectric_type.atom_1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Dielectric_type.dielectric_value">
<span class="sig-name descname"><span class="pre">dielectric_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#hymd.force.Dielectric_type.dielectric_value" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hymd.force.Dihedral">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">Dihedral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_4</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dih_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#Dihedral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.Dihedral" title="Permalink to this definition"></a></dt>
<dd><p>Dataclass representing a single four-particle bond type</p>
<p>A <cite>bond type</cite> is a bond strength and equilibrium angle associated with
any four-particle torsional bond between particles of specific types
<code class="code docutils literal notranslate"><span class="pre">A</span></code>, <code class="code docutils literal notranslate"><span class="pre">B</span></code>, <code class="code docutils literal notranslate"><span class="pre">C</span></code>, and <code class="code docutils literal notranslate"><span class="pre">D</span></code> (where <code class="code docutils literal notranslate"><span class="pre">A</span></code>, <code class="code docutils literal notranslate"><span class="pre">B</span></code>,
<code class="code docutils literal notranslate"><span class="pre">C</span></code>, and <code class="code docutils literal notranslate"><span class="pre">D</span></code> may be different or the same). Dihedral
four-particle bonds in HyMD take different forms depending on the
<code class="code docutils literal notranslate"><span class="pre">dih_type</span></code> parameter.</p>
<p>In the following, let <span class="math notranslate nohighlight">\(\phi\)</span> denote the angle between the planes
spanned by the relative positions of atoms <code class="code docutils literal notranslate"><span class="pre">A</span></code>-<code class="code docutils literal notranslate"><span class="pre">B</span></code>-<code class="code docutils literal notranslate"><span class="pre">C</span></code>
and <code class="code docutils literal notranslate"><span class="pre">B</span></code>-<code class="code docutils literal notranslate"><span class="pre">C</span></code>-<code class="code docutils literal notranslate"><span class="pre">D</span></code>. If <code class="code docutils literal notranslate"><span class="pre">dih_type</span> <span class="pre">=</span> <span class="pre">0</span></code>, then</p>
<div class="math notranslate nohighlight">
\[V_4(\phi) = \sum_n c_n
    \left(
        1 + \cos\left[
            n\phi - d_n
        \right]
    \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(c_n\)</span> are energy coefficients and <span class="math notranslate nohighlight">\(d_n\)</span> are propensity
phases. By default, the cosine sum is truncated at five terms. If
<code class="code docutils literal notranslate"><span class="pre">coeffs</span></code> provides only a single float, this is used as the coiling
propensity parameter <span class="math notranslate nohighlight">\(\lambda\)</span>. In this case, <span class="math notranslate nohighlight">\(c_n\)</span> and
<span class="math notranslate nohighlight">\(d_n\)</span> are automatically set to values which promote alpha helical
(<span class="math notranslate nohighlight">\(\lambda=-1\)</span>), beta sheet (<span class="math notranslate nohighlight">\(\lambda=1\)</span>), or a mixed
(<span class="math notranslate nohighlight">\(1&gt;\lambda&gt;-1\)</span>) structure (using values provided by Bore et al.
(2018)). In this case, the full potential takes the form</p>
<div class="math notranslate nohighlight">
\[V_4(\phi;\lambda) =
    \frac{1}{2}(1-\lambda) V_{\text{prop},\alpha}(\phi)
    +
    \frac{1}{2}(1+\lambda) V_{\text{prop},\beta}(\phi)
    +
    (1-\vert\lambda\vert) V_{\text{prop}, \text{coil}}(\phi),\]</div>
<p>with each of the <span class="math notranslate nohighlight">\(V_{\mathrm{prop}, X}\)</span> being fixed cosine series
potentials with pre-set <span class="math notranslate nohighlight">\(c_n\)</span> -s and <span class="math notranslate nohighlight">\(d_n\)</span> -s.</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">dih_type</span> <span class="pre">=</span> <span class="pre">1</span></code>, then a combined bending torsional (CBT) potential
is employed,</p>
<div class="math notranslate nohighlight">
\[V_4(\phi,\gamma;\lambda) =
    V_4(\phi;\lambda)
    +
    \frac{1}{2}K(\phi)(\gamma - \gamma_0)^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(V_4(\phi;\lambda)\)</span> specifies the potential as given by the
coiling propensity parameter above, <span class="math notranslate nohighlight">\(K(\phi)\)</span> is a separate cosine
series potential acting as the angular three-particle bond strength, and
<span class="math notranslate nohighlight">\(\gamma_0\)</span> is the three-particle bond equilibrium angle. In this
case, the <code class="code docutils literal notranslate"><span class="pre">coeffs</span></code> parameter must specify <em>both</em> a <span class="math notranslate nohighlight">\(\lambda\)</span>
value, in additon to the energy and phases dictating the <span class="math notranslate nohighlight">\(K(\phi)\)</span>
potential.</p>
<p class="rubric">References</p>
<p>Bore et al. J. Chem. Theory Comput., 14(2): 1120–1130, 2018.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>atom_1</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 1.</p>
</dd>
<dt><strong>atom_2</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 2.</p>
</dd>
<dt><strong>atom_3</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 3.</p>
</dd>
<dt><strong>atom_4</strong><span class="classifier">str</span></dt><dd><p>Type name of particle 4.</p>
</dd>
<dt><strong>coeffs</strong><span class="classifier">list[list[float]] or list[float] or numpy.ndarray</span></dt><dd><p>Dihedral coefficients defining the series expansion of the dihedral
energy.</p>
</dd>
<dt><strong>dih_type</strong><span class="classifier">int</span></dt><dd><p>Specifies the type of dihedral used; If <code class="code docutils literal notranslate"><span class="pre">0</span></code>, then <code class="code docutils literal notranslate"><span class="pre">coeffs</span></code>
must contain <strong>either</strong> two lists of five energy coefficients
<span class="math notranslate nohighlight">\(c_n\)</span> and five propensity phases <span class="math notranslate nohighlight">\(d_n\)</span> <strong>or</strong> a single
floating point number defining the <span class="math notranslate nohighlight">\(\lambda\)</span> coiling propensity
parameter. If <code class="code docutils literal notranslate"><span class="pre">1</span></code>, the combined bending-torsional potential is
used, and <code class="code docutils literal notranslate"><span class="pre">coeffs</span></code> must specify <span class="math notranslate nohighlight">\(\lambda\)</span> <em>and</em> two lists
containing energy coefficients and propensity phases for the
<span class="math notranslate nohighlight">\(V_\text{prop}\)</span> propensity potential, defined in terms of cosine
series.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Dihedral.atom_1">
<span class="sig-name descname"><span class="pre">atom_1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#hymd.force.Dihedral.atom_1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Dihedral.atom_2">
<span class="sig-name descname"><span class="pre">atom_2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#hymd.force.Dihedral.atom_2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Dihedral.atom_3">
<span class="sig-name descname"><span class="pre">atom_3</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#hymd.force.Dihedral.atom_3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Dihedral.atom_4">
<span class="sig-name descname"><span class="pre">atom_4</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#hymd.force.Dihedral.atom_4" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Dihedral.coeffs">
<span class="sig-name descname"><span class="pre">coeffs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#hymd.force.Dihedral.coeffs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.force.Dihedral.dih_type">
<span class="sig-name descname"><span class="pre">dih_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#hymd.force.Dihedral.dih_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.force.compute_angle_forces__plain">
<span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">compute_angle_forces__plain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#compute_angle_forces__plain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.compute_angle_forces__plain" title="Permalink to this definition"></a></dt>
<dd><p>Computes forces resulting from angular interactions</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.0.0: </span><code class="code docutils literal notranslate"><span class="pre">compute_angle_forces__plain</span></code> was replaced by compiled Fortran
code prior to 1.0.0 release.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.force.compute_bond_forces__plain">
<span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">compute_bond_forces__plain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_bonds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#compute_bond_forces__plain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.compute_bond_forces__plain" title="Permalink to this definition"></a></dt>
<dd><p>Computes forces resulting from bonded interactions</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.0.0: </span><code class="code docutils literal notranslate"><span class="pre">compute_bond_forces__plain</span></code> was replaced by compiled Fortran
code prior to 1.0.0 release.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.force.compute_dihedral_forces__plain">
<span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">compute_dihedral_forces__plain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_dihedrals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#compute_dihedral_forces__plain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.compute_dihedral_forces__plain" title="Permalink to this definition"></a></dt>
<dd><p>Computes forces resulting from dihedral interactions</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.0.0: </span><code class="code docutils literal notranslate"><span class="pre">compute_dihedral_forces__plain</span></code> was replaced by compiled Fortran
code prior to 1.0.0 release.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.force.dipole_forces_redistribution">
<span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">dipole_forces_redistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_on_bead</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_dipoles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_matrices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_bb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#dipole_forces_redistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.dipole_forces_redistribution" title="Permalink to this definition"></a></dt>
<dd><p>Redistribute electrostatic forces calculated from topologically
reconstructed ghost dipole point charges to the backcone atoms of the protein.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.force.find_all_paths">
<span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">find_all_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#find_all_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.find_all_paths" title="Permalink to this definition"></a></dt>
<dd><p>Helper function that recursively finds all paths of given lenght ‘n + 1’ inside a network ‘G’.
Adapted from <a class="reference external" href="https://stackoverflow.com/a/28103735">https://stackoverflow.com/a/28103735</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.force.prepare_bonds">
<span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">prepare_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#prepare_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.prepare_bonds" title="Permalink to this definition"></a></dt>
<dd><p>Rearrange the bond information for usage in compiled Fortran kernels</p>
<p>Restructures the lists resulting from the execution of
<code class="code docutils literal notranslate"><span class="pre">prepare_bonds_old</span></code> into numpy arrays suitable for calls to optimized
Fortran code calculating bonded forces and energiesself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>molecules</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of integer molecule affiliation for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.
Global (across all MPI ranks) or local (local indices on this MPI rank
only) may be used, both, without affecting the result.</p>
</dd>
<dt><strong>names</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of type names for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>bonds</strong><span class="classifier">(N,M) numpy.ndarray</span></dt><dd><p>Array of <code class="code docutils literal notranslate"><span class="pre">M</span></code> bonds originating from each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>indices</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of integer indices for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles. Global
(across all MPI ranks) or local (local indices on this MPI rank only)
may be used, both, without affecting the result.</p>
</dd>
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>bonds_2_atom_1</strong><span class="classifier">(B,) numpy.ndarray</span></dt><dd><p>Local index of particle 1 for each of <code class="code docutils literal notranslate"><span class="pre">B</span></code> constructed
two-particle bonds.</p>
</dd>
<dt><strong>bonds_2_atom_2</strong><span class="classifier">(B,) numpy.ndarray</span></dt><dd><p>Local index of particle 2 for each of <code class="code docutils literal notranslate"><span class="pre">B</span></code> constructed
two-particle bonds.</p>
</dd>
<dt><strong>bonds_2_equilibrium</strong><span class="classifier">(B,) numpy.ndarray</span></dt><dd><p>Equilibrium distance for each of <code class="code docutils literal notranslate"><span class="pre">B</span></code> constructed two-particle
bonds.</p>
</dd>
<dt><strong>bonds_2_strength</strong><span class="classifier">(B,) numpy.ndarray</span></dt><dd><p>Bond strength for each of <code class="code docutils literal notranslate"><span class="pre">B</span></code> constructed two-particle
bonds.</p>
</dd>
<dt><strong>bonds_3_atom_1</strong><span class="classifier">(A,) numpy.ndarray</span></dt><dd><p>Local index of particle 1 for each of <code class="code docutils literal notranslate"><span class="pre">A</span></code> constructed
three-particle bonds.</p>
</dd>
<dt><strong>bonds_3_atom_2</strong><span class="classifier">(A,) numpy.ndarray</span></dt><dd><p>Local index of particle 2 for each of <code class="code docutils literal notranslate"><span class="pre">A</span></code> constructed
three-particle bonds.</p>
</dd>
<dt><strong>bonds_3_atom_3</strong><span class="classifier">(A,) numpy.ndarray</span></dt><dd><p>Local index of particle 3 for each of <code class="code docutils literal notranslate"><span class="pre">A</span></code> constructed
three-particle bonds.</p>
</dd>
<dt><strong>bonds_3_equilibrium</strong><span class="classifier">(A,) numpy.ndarray</span></dt><dd><p>Equilibrium angle for each of <code class="code docutils literal notranslate"><span class="pre">A</span></code> constructed three-particle
bonds.</p>
</dd>
<dt><strong>bonds_3_strength</strong><span class="classifier">(A,) numpy.ndarray</span></dt><dd><p>Bond strength for each of <code class="code docutils literal notranslate"><span class="pre">A</span></code> constructed three-particle
bonds.</p>
</dd>
<dt><strong>bonds_4_atom_1</strong><span class="classifier">(D,) numpy.ndarray</span></dt><dd><p>Local index of particle 1 for each of <code class="code docutils literal notranslate"><span class="pre">D</span></code> constructed
four-particle bonds.</p>
</dd>
<dt><strong>bonds_4_atom_2</strong><span class="classifier">(D,) numpy.ndarray</span></dt><dd><p>Local index of particle 2 for each of <code class="code docutils literal notranslate"><span class="pre">D</span></code> constructed
four-particle bonds.</p>
</dd>
<dt><strong>bonds_4_atom_3</strong><span class="classifier">(D,) numpy.ndarray</span></dt><dd><p>Local index of particle 3 for each of <code class="code docutils literal notranslate"><span class="pre">D</span></code> constructed
four-particle bonds.</p>
</dd>
<dt><strong>bonds_4_atom_4</strong><span class="classifier">(D,) numpy.ndarray</span></dt><dd><p>Local index of particle 4 for each of <code class="code docutils literal notranslate"><span class="pre">D</span></code> constructed
four-particle bonds.</p>
</dd>
<dt><strong>bonds_4_coeff</strong><span class="classifier">(D,) numpy.ndarray</span></dt><dd><p>Cosine series coefficients for each of <code class="code docutils literal notranslate"><span class="pre">D</span></code> constructed
four-particle bonds.</p>
</dd>
<dt><strong>bonds_4_type</strong><span class="classifier">(D,) numpy.ndarray</span></dt><dd><p>Dihedral type for each of <code class="code docutils literal notranslate"><span class="pre">D</span></code> constructed four-particle
bonds.</p>
</dd>
<dt><strong>bonds_4_last</strong><span class="classifier">(D,) numpy.ndarray</span></dt><dd><p>Flags indicating if <code class="code docutils literal notranslate"><span class="pre">dih_type</span></code> is <code class="code docutils literal notranslate"><span class="pre">1</span></code> for each of <code class="code docutils literal notranslate"><span class="pre">D</span></code>
constructed four-particle bonds.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.force.prepare_bonds_old" title="hymd.force.prepare_bonds_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_bonds_old</span></code></a></dt><dd><p>Used internally to reconstruct the bonded interactions types from the connectivity information in the structure/topology input file and the bonded types specified in the configuration file.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.force.prepare_bonds_old">
<span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">prepare_bonds_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#prepare_bonds_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.prepare_bonds_old" title="Permalink to this definition"></a></dt>
<dd><p>Find bonded interactions from connectivity and bond types information</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.0.0: </span><code class="code docutils literal notranslate"><span class="pre">prepare_bonds_old</span></code> was replaced by <code class="code docutils literal notranslate"><span class="pre">prepare_bonds</span></code> for
use with compiled Fortran kernels prior to 1.0.0 release.</p>
</div>
<p>Prepares the necessary equilibrium and bond strength information needed by
the intramolecular interaction functions. This is performed locally on each
MPI rank, as the domain decomposition ensures that for all molecules <em>all</em>
consituent particles are always contained on <em>the same</em> MPI rankself.</p>
<p>This function traverses the bond connectivity information provided in the
structure/topology input file and indentifies any two-, three-, or
four-particle potential bonds. For each connected chain of two, three, or
four particles, a matching to bond types is attempted. If the corresponding
names match, a bond object is initialized.</p>
<p>In order to investigate the connectivity, a graph is created using
networkx functionality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>molecules</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of integer molecule affiliation for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.
Global (across all MPI ranks) or local (local indices on this MPI rank
only) may be used, both, without affecting the result.</p>
</dd>
<dt><strong>names</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of type names for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>bonds</strong><span class="classifier">(N,M) numpy.ndarray</span></dt><dd><p>Array of <code class="code docutils literal notranslate"><span class="pre">M</span></code> bonds originating from each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>indices</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of integer indices for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles. Global
(across all MPI ranks) or local (local indices on this MPI rank only)
may be used, both, without affecting the result.</p>
</dd>
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>bonds_2</strong><span class="classifier">list</span></dt><dd><p>List of lists containing <em>local</em> particle indices, equilibrium
distance, and bond strength coefficient for each reconstructed
two-particle bond.</p>
</dd>
<dt>bonds_3</dt><dd><p>List of lists containing <em>local</em> particle indices, equilibrium angle,
and bond strength coefficient for each reconstructed three-particle
bond.</p>
</dd>
<dt>bonds_4</dt><dd><p>List of lists containing <em>local</em> particle indices, dihedral type index,
and dihedral coefficients for each reconstructed four-particle
torsional bond.</p>
</dd>
<dt><strong>bb_index</strong><span class="classifier">list</span></dt><dd><p>List indicating the dihedral type of each four-particle bond in
<code class="code docutils literal notranslate"><span class="pre">bonds_4</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.force.Bond" title="hymd.force.Bond"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bond</span></code></a></dt><dd><p>Two-particle bond type dataclass.</p>
</dd>
<dt><a class="reference internal" href="#hymd.force.Angle" title="hymd.force.Angle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Angle</span></code></a></dt><dd><p>Three-particle angular bond type dataclass.</p>
</dd>
<dt><a class="reference internal" href="#hymd.force.Dihedral" title="hymd.force.Dihedral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Dihedral</span></code></a></dt><dd><p>Four-particle torsional bond type dataclass.</p>
</dd>
<dt><a class="reference internal" href="#hymd.input_parser.Config" title="hymd.input_parser.Config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.input_parser.Config</span></code></a></dt><dd><p>Configuration dataclass handler.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.force.prepare_index_based_bonds">
<span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">prepare_index_based_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#prepare_index_based_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.prepare_index_based_bonds" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.force.propensity_potential_coeffs">
<span class="sig-prename descclassname"><span class="pre">hymd.force.</span></span><span class="sig-name descname"><span class="pre">propensity_potential_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/force.html#propensity_potential_coeffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.force.propensity_potential_coeffs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="logger">
<h2><span class="section-number">4.5. </span>Logger<a class="headerlink" href="#logger" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="hymd.logger.Logger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.logger.</span></span><span class="sig-name descname"><span class="pre">Logger</span></span><a class="reference internal" href="../_modules/hymd/logger.html#Logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.logger.Logger" title="Permalink to this definition"></a></dt>
<dd><p>Log output handler class</p>
<p class="rubric">Notes</p>
<p>This wraps the default python library <code class="code docutils literal notranslate"><span class="pre">logging</span></code>, see
<a class="reference external" href="https://docs.python.org/3/library/logging.html">docs.python.org/3/library/logging.html</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>level</strong><span class="classifier">int</span></dt><dd><p>Determines the verbosity level of the log, corresponding to
logging.level. Numerical values <code class="code docutils literal notranslate"><span class="pre">50</span></code> (<code class="code docutils literal notranslate"><span class="pre">logging.CRITICAL</span></code>),
<code class="code docutils literal notranslate"><span class="pre">40</span></code> (<code class="code docutils literal notranslate"><span class="pre">logging.ERROR</span></code>), <code class="code docutils literal notranslate"><span class="pre">30</span></code>
(<code class="code docutils literal notranslate"><span class="pre">logging.WARNING</span></code>), <code class="code docutils literal notranslate"><span class="pre">20</span></code> (<code class="code docutils literal notranslate"><span class="pre">logging.INFO</span></code>),
<code class="code docutils literal notranslate"><span class="pre">10</span></code> (<code class="code docutils literal notranslate"><span class="pre">logging.DEBUG</span></code>), and <code class="code docutils literal notranslate"><span class="pre">0</span></code>
(<code class="code docutils literal notranslate"><span class="pre">logging.UNSET</span></code>) are supported values. Any log event message
less severe than the specified level is ignored. All other event
messages are emitted.</p>
</dd>
<dt><strong>log_file</strong><span class="classifier">str</span></dt><dd><p>Path to output log file.</p>
</dd>
<dt><strong>format</strong><span class="classifier">str</span></dt><dd><p>Prepended dump string for each log event. Specifies the log event
level, the module emitting the event, the code line, the enclosing
function name, and the MPI rank writing the message.</p>
</dd>
<dt><strong>date_format</strong><span class="classifier">str</span></dt><dd><p>Prepends the date before all log event messages.</p>
</dd>
<dt><strong>formatter</strong><span class="classifier">logging.Formatter</span></dt><dd><p>Formatter handling the prepending of the information in <cite>format</cite> and
<cite>date_format</cite> to each log event message. Used by default for all
loggers.</p>
</dd>
<dt><strong>rank0</strong><span class="classifier">logging.Logger</span></dt><dd><p>Default logger object for the root MPI rank.</p>
</dd>
<dt><strong>all_ranks</strong><span class="classifier">logging.Logger</span></dt><dd><p>Default logger object for messages being emitted from all MPI ranks
simultaneously.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="hymd.logger.Logger.setup">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_level=20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_file=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/logger.html#Logger.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.logger.Logger.setup" title="Permalink to this definition"></a></dt>
<dd><p>Sets up the logger object.</p>
<p>If a <code class="code docutils literal notranslate"><span class="pre">log_file</span></code> path is provided, log event messages are output
to it. Otherwise, the logging messages are emitted to stdout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>default_level</strong><span class="classifier">int, optional</span></dt><dd><p>Default verbosity level of the logger. Unless specified, it is
<code class="code docutils literal notranslate"><span class="pre">10</span></code> (<code class="code docutils literal notranslate"><span class="pre">logging.INFO</span></code>).</p>
</dd>
<dt><strong>log_file</strong><span class="classifier">str, optional</span></dt><dd><p>Path to output log file. If <cite>None</cite> or not priovided, no log file is
used and all logging is done to stdout.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool, optional</span></dt><dd><p>Increases the logging level to <code class="code docutils literal notranslate"><span class="pre">30</span></code> (<code class="code docutils literal notranslate"><span class="pre">logging.WARNING</span></code>)
if True, otherwise leaves the logging level unchanged.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hymd.logger.MPIFilterRoot">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.logger.</span></span><span class="sig-name descname"><span class="pre">MPIFilterRoot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/logger.html#MPIFilterRoot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.logger.MPIFilterRoot" title="Permalink to this definition"></a></dt>
<dd><p>Log output Filter wrapper class for the root MPI rank log</p>
<dl class="py method">
<dt class="sig sig-object py" id="hymd.logger.MPIFilterRoot.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/logger.html#MPIFilterRoot.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.logger.MPIFilterRoot.filter" title="Permalink to this definition"></a></dt>
<dd><p>Log event message filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>record</strong><span class="classifier">logging.LogRecord</span></dt><dd><p>LogRecord object corresponding to the log event.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hymd.logger.MPIFilterAll">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.logger.</span></span><span class="sig-name descname"><span class="pre">MPIFilterAll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/logger.html#MPIFilterAll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.logger.MPIFilterAll" title="Permalink to this definition"></a></dt>
<dd><p>Log output Filter wrapper class for the all-MPI-ranks log</p>
<dl class="py method">
<dt class="sig sig-object py" id="hymd.logger.MPIFilterAll.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/logger.html#MPIFilterAll.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.logger.MPIFilterAll.filter" title="Permalink to this definition"></a></dt>
<dd><p>Log event message filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>record</strong><span class="classifier">logging.LogRecord</span></dt><dd><p>LogRecord object corresponding to the log event.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-hymd.input_parser">
<span id="input-parser"></span><h2><span class="section-number">4.6. </span>Input parser<a class="headerlink" href="#module-hymd.input_parser" title="Permalink to this heading"></a></h2>
<p>Parses and handles the configuration information provided for the simulation</p>
<dl class="py class">
<dt class="sig sig-object py" id="hymd.input_parser.Config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">Config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step:</span> <span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_size:</span> <span class="pre">~typing.List[int]</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma:</span> <span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa:</span> <span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size:</span> <span class="pre">~typing.List[float]</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_print:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_temperature:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">bool</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_temperature:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">bool</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamiltonian:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain_decomposition:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">bool</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrator:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">respa_inner:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'&lt;config</span> <span class="pre">file</span> <span class="pre">path</span> <span class="pre">unknown&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags:</span> <span class="pre">~typing.List[str]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds:</span> <span class="pre">~typing.List[~hymd.force.Bond]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_bonds:</span> <span class="pre">~typing.List[~hymd.force.Angle]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedrals:</span> <span class="pre">~typing.List[~hymd.force.Dihedral]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi:</span> <span class="pre">~typing.List[~hymd.force.Chi]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_particles:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_molecule_size:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_flush:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermostat_work:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermostat_coupling_groups:</span> <span class="pre">~typing.List[~typing.List[str]]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_energy:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cancel_com_momentum:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coulombtype:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_type:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol_mixing:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dielectric_const:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_crit:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dielectric_type:</span> <span class="pre">~typing.List[~hymd.force.Dielectric_type]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_energy:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_charges:</span> <span class="pre">~typing.List[float]</span> <span class="pre">|</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">barostat:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">barostat_type:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_p:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_pressure:</span> <span class="pre">~typing.List[~hymd.barostat.Target_pressure]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_b:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m:</span> <span class="pre">~typing.List[float]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#Config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.Config" title="Permalink to this definition"></a></dt>
<dd><p>Configuration object</p>
<p>Handles and verifies the simulation configuration specified in the
configuration file.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.input_parser.Bond</span></code></dt><dd><p>Two-particle bond type dataclass.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.input_parser.Angle</span></code></dt><dd><p>Three-particle bond type dataclass.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">hymd.input_parser.Dihedral</span></code></dt><dd><p>Four-particle bond type dataclass.</p>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>gas_constant</strong><span class="classifier">float</span></dt><dd><p>Constant value of the gas constant, R (equivalently the Boltzmann
constant) in the units used internally in HyMD.</p>
</dd>
<dt><strong>coulomb_constant</strong><span class="classifier">float</span></dt><dd><p>Constant value of the Coulomb constant which converts electric field
values to forces and electric potential values to energies in the units
used internally in HyMD.</p>
</dd>
<dt><strong>n_steps: int</strong></dt><dd><p>Number of time steps in the simulation.</p>
</dd>
<dt><strong>time_step: float</strong></dt><dd><p><em>Outer</em> time step used in the simulation. If the rRESPA intergrator is
used, the <em>inner</em> time step (the time step used in the integration of
intramolecular bending, stretching, and torsional forces) is
<code class="code docutils literal notranslate"><span class="pre">time_step</span> <span class="pre">/</span> <span class="pre">respa_inner</span></code>.</p>
</dd>
<dt><strong>box_size</strong><span class="classifier">list[float] or (D,) numpy.ndarray</span></dt><dd><p>Simulation box size of simulation in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions in units of
nanometers.</p>
</dd>
<dt><strong>mesh_size</strong><span class="classifier">list[int] or int or numpy.ndarray</span></dt><dd><p>Number of grid points used for the discrete density grid.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float</span></dt><dd><p>Filter width representing the effective coarse-graining level of the
particles in the simulation.</p>
</dd>
<dt><strong>kappa</strong><span class="classifier">float</span></dt><dd><p>Compressibility parameter used in the relaxed incompressibility term in
the interaction energy functional.</p>
</dd>
<dt><strong>n_print</strong><span class="classifier">int, optional</span></dt><dd><p>Frequency of trajectory/energy output to the H5MD trajectory/energy
output file (in units of number of time steps).</p>
</dd>
<dt><strong>tau</strong><span class="classifier">float, optional</span></dt><dd><p>The time scale of the CSVR thermostat coupling.</p>
</dd>
<dt><strong>start_temperature</strong><span class="classifier">float, optional</span></dt><dd><p>Generate starting temperature by assigning all particle velocities
randomly according to the Maxwell-Boltzmann distribution at
<code class="code docutils literal notranslate"><span class="pre">start_temperature</span></code> Kelvin prior to starting the simulation.</p>
</dd>
<dt><strong>target_temperature</strong><span class="classifier">float, optional</span></dt><dd><p>Couple the system to a heat bath at <code class="code docutils literal notranslate"><span class="pre">target_temperature</span></code> Kelvin.</p>
</dd>
<dt><strong>mass</strong><span class="classifier">float, optional</span></dt><dd><p>Mass of the particles in the simulation.</p>
</dd>
<dt><strong>hamiltonian</strong><span class="classifier">str, optional</span></dt><dd><p>Specifies the interaction energy functional <span class="math notranslate nohighlight">\(W[\tilde\phi]\)</span>
for use with the particle-field interactions. Options:
<code class="code docutils literal notranslate"><span class="pre">SquaredPhi</span></code>, <code class="code docutils literal notranslate"><span class="pre">DefaultNohChi</span></code>, or <code class="code docutils literal notranslate"><span class="pre">DefaultWithChi</span></code>.</p>
</dd>
<dt><strong>domain_decomposition</strong><span class="classifier">int, optional</span></dt><dd><p>Specifies the interval (in time steps) of domain decomposition
exchange, involving all MPI ranks sending and receiving particles
according to the particles’ positions in the integration box and the
MPI ranks’ assigned domain.</p>
</dd>
<dt><strong>integrator</strong><span class="classifier">str, optional</span></dt><dd><p>Specifies the time integrator used in the simulation. Options:
<code class="code docutils literal notranslate"><span class="pre">velocity-verlet</span></code> or <code class="code docutils literal notranslate"><span class="pre">respa</span></code>.</p>
</dd>
<dt><strong>respa_inner</strong><span class="classifier">int, optional</span></dt><dd><p>The number of inner time steps in the rRESPA integrator. This denotes
the number of intramolecular force calculations (stretching, bending,
torsional) are performed between each impulse applied from the field
forces.</p>
</dd>
<dt><strong>file_name</strong><span class="classifier">str, optional</span></dt><dd><p>File path of the parsed configuration file.</p>
</dd>
<dt><strong>name</strong><span class="classifier">str, optional</span></dt><dd><p>Name for the simulation.</p>
</dd>
<dt><strong>tags</strong><span class="classifier">list[str], optional</span></dt><dd><p>Tags for the simulation.</p>
</dd>
<dt><strong>bonds</strong><span class="classifier">list[Bond], optional</span></dt><dd><p>Specifies harmonic stretching potentials between particles in the
same molecule.</p>
</dd>
<dt><strong>angle_bonds</strong><span class="classifier">list[Angle], optional</span></dt><dd><p>Specifies harmonic angular bending potentials between particles in the
same molecule.</p>
</dd>
<dt><strong>dihedrals</strong><span class="classifier">list[Dihedral], optional</span></dt><dd><p>Specifies four-particle torsional potentials by cosine series.</p>
</dd>
<dt><strong>chi</strong><span class="classifier">list[Chi], optional</span></dt><dd><p>Specifies <span class="math notranslate nohighlight">\(\chi\)</span>-interaction parameters between particle
species.</p>
</dd>
<dt><strong>n_particles</strong><span class="classifier">int, optional</span></dt><dd><p>Specifies the total number of particles in the input. Optional keyword
for validation, ensuring the input HDF5 topology has the correct number
of particles and molecules.</p>
</dd>
<dt><strong>max_molecule_size</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum size of any single molecule in the system. Used to speed up
distribution of particles onto MPI ranks in a parallel fashion.</p>
</dd>
<dt><strong>n_flush</strong><span class="classifier">int, optional</span></dt><dd><p>Frequency of HDF5 write buffer flush, forcing trajectory/energy to be
written to disk (in units of number of <code class="code docutils literal notranslate"><span class="pre">n_print</span></code>).</p>
</dd>
<dt><strong>thermostat_work</strong><span class="classifier">float</span></dt><dd><p>Work performed by the thermostat on the system.</p>
</dd>
<dt><strong>thermostat_coupling_groups</strong><span class="classifier">list[str], optional</span></dt><dd><p>Specifies individual groups coupling independently to the CSVR
thermostat. E.g. in a system containing <code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code>, <code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code>, and
<code class="code docutils literal notranslate"><span class="pre">&quot;C&quot;</span></code> type particles,
<code class="code docutils literal notranslate"><span class="pre">thermostat_coupling_groups</span> <span class="pre">=</span> <span class="pre">[[&quot;A&quot;,</span> <span class="pre">&quot;B&quot;],</span> <span class="pre">[&quot;C&quot;],]</span></code> would
thermalise types <code class="code docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> and <code class="code docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code> together and couple
<code class="code docutils literal notranslate"><span class="pre">&quot;C&quot;</span></code> type particles to a different thermostat (all individual
thermostats are at the same temperature, i.e. target_temperature
Kelvin).</p>
</dd>
<dt><strong>initial_energy</strong><span class="classifier">float</span></dt><dd><p>Value of the total energy prior to the start of the simulation.</p>
</dd>
<dt><strong>cancel_com_momentum</strong><span class="classifier">int, optional</span></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, the total linear momentum of the center of mass is
removed before starting the simulation. If an integer is specifed, the
total linear momentum of the center of mass is removed every
<code class="code docutils literal notranslate"><span class="pre">remove_com_momentum</span></code> time steps. If <code class="code docutils literal notranslate"><span class="pre">False</span></code>, the linear
momentum is never removed.</p>
</dd>
<dt><strong>coulombtype</strong><span class="classifier">str, optional</span></dt><dd><p>Specifies the type of electrostatic Coulomb interactions in the system.
The strength of the electrostatic forces is modulated by the relative
dielectric constant of the simulation medium, specified with the
<code class="code docutils literal notranslate"><span class="pre">dielectric_const</span></code> keyword. Charges for individual particles are
specified in the structure/topology HDF5 input file, not in the
configuration file. If no charges (or peptide backbone dipoles) are
present, the electrostatic forces will not be calculated even if this
keyword is set to <code class="code docutils literal notranslate"><span class="pre">&quot;PIC_Spectral&quot;</span></code>.</p>
</dd>
<dt><strong>dielectric_const</strong><span class="classifier">float, optional</span></dt><dd><p>Specifies the relative dielectric constant of the simulation medium
which regulates the strength of the electrostatic interactions. When
using helical propensity dihedrals, this keyword must be specified—even
if electrostatics are not included with the <code class="code docutils literal notranslate"><span class="pre">coulombtype</span></code>
keyword.</p>
</dd>
<dt><strong>dielectric_type: list[float], optional</strong></dt><dd><p>Specifies the relative dielectric constant of the simulation medium
which regulates the strength of the electrostatic interactions. The list assigns
relative dielectric values to each bead type, and an anisotropic
dielectric function is obtained from a weighted average.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.a" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.angle_bonds">
<span class="sig-name descname"><span class="pre">angle_bonds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hymd.force.Angle" title="hymd.force.Angle"><span class="pre">Angle</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hymd.input_parser.Config.angle_bonds" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.barostat">
<span class="sig-name descname"><span class="pre">barostat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.barostat" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.barostat_type">
<span class="sig-name descname"><span class="pre">barostat_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.barostat_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.bonds">
<span class="sig-name descname"><span class="pre">bonds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hymd.force.Bond" title="hymd.force.Bond"><span class="pre">Bond</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hymd.input_parser.Config.bonds" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.box_size">
<span class="sig-name descname"><span class="pre">box_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.box_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.cancel_com_momentum">
<span class="sig-name descname"><span class="pre">cancel_com_momentum</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#hymd.input_parser.Config.cancel_com_momentum" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.chi">
<span class="sig-name descname"><span class="pre">chi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hymd.force.Chi" title="hymd.force.Chi"><span class="pre">Chi</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hymd.input_parser.Config.chi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.conv_crit">
<span class="sig-name descname"><span class="pre">conv_crit</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.conv_crit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.convergence_type">
<span class="sig-name descname"><span class="pre">convergence_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.convergence_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.coulomb_constant">
<span class="sig-name descname"><span class="pre">coulomb_constant</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">138.935458</span></em><a class="headerlink" href="#hymd.input_parser.Config.coulomb_constant" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.coulombtype">
<span class="sig-name descname"><span class="pre">coulombtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.coulombtype" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.dielectric_const">
<span class="sig-name descname"><span class="pre">dielectric_const</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.dielectric_const" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.dielectric_type">
<span class="sig-name descname"><span class="pre">dielectric_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hymd.force.Dielectric_type" title="hymd.force.Dielectric_type"><span class="pre">Dielectric_type</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hymd.input_parser.Config.dielectric_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.dihedrals">
<span class="sig-name descname"><span class="pre">dihedrals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hymd.force.Dihedral" title="hymd.force.Dihedral"><span class="pre">Dihedral</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hymd.input_parser.Config.dihedrals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.domain_decomposition">
<span class="sig-name descname"><span class="pre">domain_decomposition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.domain_decomposition" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.dtype">
<span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.dtype" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.file_name">
<span class="sig-name descname"><span class="pre">file_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'&lt;config</span> <span class="pre">file</span> <span class="pre">path</span> <span class="pre">unknown&gt;'</span></em><a class="headerlink" href="#hymd.input_parser.Config.file_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.gas_constant">
<span class="sig-name descname"><span class="pre">gas_constant</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0083144621</span></em><a class="headerlink" href="#hymd.input_parser.Config.gas_constant" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.hamiltonian">
<span class="sig-name descname"><span class="pre">hamiltonian</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.hamiltonian" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.initial_energy">
<span class="sig-name descname"><span class="pre">initial_energy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.initial_energy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.integrator">
<span class="sig-name descname"><span class="pre">integrator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.integrator" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.kappa">
<span class="sig-name descname"><span class="pre">kappa</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#hymd.input_parser.Config.kappa" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.m">
<span class="sig-name descname"><span class="pre">m</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hymd.input_parser.Config.m" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.mass">
<span class="sig-name descname"><span class="pre">mass</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.mass" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.max_molecule_size">
<span class="sig-name descname"><span class="pre">max_molecule_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.max_molecule_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.mesh_size">
<span class="sig-name descname"><span class="pre">mesh_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#hymd.input_parser.Config.mesh_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.n_b">
<span class="sig-name descname"><span class="pre">n_b</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.n_b" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.n_flush">
<span class="sig-name descname"><span class="pre">n_flush</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.n_flush" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.n_particles">
<span class="sig-name descname"><span class="pre">n_particles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.n_particles" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.n_print">
<span class="sig-name descname"><span class="pre">n_print</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.n_print" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.n_steps">
<span class="sig-name descname"><span class="pre">n_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#hymd.input_parser.Config.n_steps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.pol_mixing">
<span class="sig-name descname"><span class="pre">pol_mixing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.pol_mixing" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.pressure">
<span class="sig-name descname"><span class="pre">pressure</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#hymd.input_parser.Config.pressure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.respa_inner">
<span class="sig-name descname"><span class="pre">respa_inner</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#hymd.input_parser.Config.respa_inner" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.rho0">
<span class="sig-name descname"><span class="pre">rho0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.rho0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.self_energy">
<span class="sig-name descname"><span class="pre">self_energy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.self_energy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#hymd.input_parser.Config.sigma" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.start_temperature">
<span class="sig-name descname"><span class="pre">start_temperature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.start_temperature" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.tags">
<span class="sig-name descname"><span class="pre">tags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hymd.input_parser.Config.tags" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.target_pressure">
<span class="sig-name descname"><span class="pre">target_pressure</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Target_pressure</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hymd.input_parser.Config.target_pressure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.target_temperature">
<span class="sig-name descname"><span class="pre">target_temperature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.target_temperature" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.tau" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.tau_p">
<span class="sig-name descname"><span class="pre">tau_p</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.tau_p" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.thermostat_coupling_groups">
<span class="sig-name descname"><span class="pre">thermostat_coupling_groups</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#hymd.input_parser.Config.thermostat_coupling_groups" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.thermostat_work">
<span class="sig-name descname"><span class="pre">thermostat_work</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#hymd.input_parser.Config.thermostat_work" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.time_step">
<span class="sig-name descname"><span class="pre">time_step</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#hymd.input_parser.Config.time_step" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hymd.input_parser.Config.type_charges">
<span class="sig-name descname"><span class="pre">type_charges</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#hymd.input_parser.Config.type_charges" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_NPT_conditions">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_NPT_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_NPT_conditions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_NPT_conditions" title="Permalink to this definition"></a></dt>
<dd><p>Check validity of barostat_type, barostat,
a, rho0, target_pressure, tau_p</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_angles">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_angles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_angles" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_bonds">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_bonds" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_box_size">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_box_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_box_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_box_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_cancel_com_momentum">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_cancel_com_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_cancel_com_momentum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_cancel_com_momentum" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_charges">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_charges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_charges" title="Permalink to this definition"></a></dt>
<dd><p>Check if charges across ranks sum to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>charges</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of floats with charges for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm, optional</span></dt><dd><p>MPI communicator, defaults to <code class="code docutils literal notranslate"><span class="pre">mpi4py.COMM_WORLD</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_charges_types_list">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_charges_types_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_charges_types_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_charges_types_list" title="Permalink to this definition"></a></dt>
<dd><p>Creates a list of charge values of length types.
Charges are sorted according to type ID. Used in field.py.
# TODO: this is messy, we should fix it</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_chi">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_chi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_chi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_chi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_config">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_config" title="Permalink to this definition"></a></dt>
<dd><p>Performs various checks on the specfied config to ensure consistency</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
<dt><strong>indices</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of integer indices for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>names</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of string names for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>types</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of integer type indices for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>charges</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of floats charges for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm, optional</span></dt><dd><p>MPI communicator, defaults to <code class="code docutils literal notranslate"><span class="pre">mpi4py.COMM_WORLD</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Validated configuration object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_dielectric">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_dielectric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_dielectric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_dielectric" title="Permalink to this definition"></a></dt>
<dd><p>Error handling for electrostatics.
Unit testing of toml/tomli input.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_dihedrals">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_dihedrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_dihedrals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_dihedrals" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_domain_decomposition">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_domain_decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_domain_decomposition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_domain_decomposition" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_hamiltonian">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_hamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_hamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_hamiltonian" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_integrator">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_integrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_integrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_integrator" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_m">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_m" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_mass">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_mass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_mass" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_max_molecule_size">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_max_molecule_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_max_molecule_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_max_molecule_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_n_b">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_n_b</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_n_b"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_n_b" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_n_flush">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_n_flush</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_n_flush"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_n_flush" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_n_particles">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_n_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_n_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_n_particles" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_n_print">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_n_print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_n_print"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_n_print" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_name">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_start_and_target_temperature">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_start_and_target_temperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_start_and_target_temperature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_start_and_target_temperature" title="Permalink to this definition"></a></dt>
<dd><p>Validate provided starting and target thermostat temperatures</p>
<p>Assesses the provided temperature target and ensures it is a non-negative
floating point number or <code class="code docutils literal notranslate"><span class="pre">False</span></code>. Ensures the starting temperature is
a non-negative floating point number or <code class="code docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>If the value for either is <code class="code docutils literal notranslate"><span class="pre">None</span></code>, the returned configuration object
has the values defaulted to <code class="code docutils literal notranslate"><span class="pre">False</span></code> in each case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>validated_config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object with validated <code class="code docutils literal notranslate"><span class="pre">target_temperature</span></code> and
<code class="code docutils literal notranslate"><span class="pre">start_temperature</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_tau">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_tau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_tau" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.check_thermostat_coupling_groups">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">check_thermostat_coupling_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#check_thermostat_coupling_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.check_thermostat_coupling_groups" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.parse_config_toml">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">parse_config_toml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toml_content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_path=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#parse_config_toml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.parse_config_toml" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.read_config_toml">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">read_config_toml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#read_config_toml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.read_config_toml" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.input_parser.sort_dielectric_by_type_id">
<span class="sig-prename descclassname"><span class="pre">hymd.input_parser.</span></span><span class="sig-name descname"><span class="pre">sort_dielectric_by_type_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/input_parser.html#sort_dielectric_by_type_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.input_parser.sort_dielectric_by_type_id" title="Permalink to this definition"></a></dt>
<dd><p>Creates a list of length N CG-particles, sorted after the charges from
the input HDF5 file. Used in file_io.py</p>
</dd></dl>

</section>
<section id="module-hymd.field">
<span id="field"></span><h2><span class="section-number">4.7. </span>Field<a class="headerlink" href="#module-hymd.field" title="Permalink to this heading"></a></h2>
<p>Forces and energies from the discretized particle-field grid interactions</p>
<dl class="py function">
<dt class="sig sig-object py" id="hymd.field.compute_field_and_kinetic_energy">
<span class="sig-prename descclassname"><span class="pre">hymd.field.</span></span><span class="sig-name descname"><span class="pre">compute_field_and_kinetic_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_ext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/field.html#compute_field_and_kinetic_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.field.compute_field_and_kinetic_energy" title="Permalink to this definition"></a></dt>
<dd><p>Compute the particle-field and kinetic energy contributions</p>
<p>Calculates the kinetic energy through</p>
<div class="math notranslate nohighlight">
\[E_k = \sum_j \frac{1}{2}m_j\mathbf{v}_j\cdot\mathbf{v}_j,\]</div>
<p>and the particle-field energy by</p>
<div class="math notranslate nohighlight">
\[E_\text{field} = \int\mathrm{d}\mathbf{r}\,
    w[\tilde\phi],\]</div>
<p>where <span class="math notranslate nohighlight">\(w\)</span> is the interaction energy functional <cite>density</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>phi</strong><span class="classifier">list[pmesh.pm.RealField]</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> objects containing discretized particle number
density values on the computational grid; one for each particle type.
Local for each MPI rank–the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>velocity</strong><span class="classifier">(N,D) numpy.ndarray</span></dt><dd><p>Array of velocities for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.
Local for each MPI rank.</p>
</dd>
<dt><strong>hamiltonian</strong><span class="classifier">Hamiltonian</span></dt><dd><p>Particle-field interaction energy handler object. Defines the
grid-independent filtering function, <span class="math notranslate nohighlight">\(H\)</span>.</p>
</dd>
<dt><strong>positions</strong><span class="classifier">(N,D) numpy.ndarray</span></dt><dd><p>Array of positions for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.
Local for each MPI rank.</p>
</dd>
<dt><strong>types</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of type indices for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles. Local for each
MPI rank.</p>
</dd>
<dt><strong>v_ext</strong><span class="classifier">list[pmesh.pm.RealField]</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> objects containing discretized particle-field
external potential values on the computational grid; one for each
particle type. Local for each MPI rank–the full computational grid is
represented by the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
<dt><strong>layouts</strong><span class="classifier">list[pmesh.domain.Layout]</span></dt><dd><p>Pmesh communication layout objects for domain decompositions of each
particle type. Used as blueprint by <code class="code docutils literal notranslate"><span class="pre">pmesh.pm.readout</span></code> for
exchange of particle information across MPI ranks as necessary.</p>
</dd>
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm</span></dt><dd><p>MPI communicator to use for rank commuication.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.field.update_field" title="hymd.field.update_field"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_field</span></code></a></dt><dd><p>Computes the up-to-date external potential for use in calculating the particle-field energy.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.field.compute_field_energy_q_GPE">
<span class="sig-prename descclassname"><span class="pre">hymd.field.</span></span><span class="sig-name descname"><span class="pre">compute_field_energy_q_GPE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_q_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dot_elec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/field.html#compute_field_energy_q_GPE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.field.compute_field_energy_q_GPE" title="Permalink to this definition"></a></dt>
<dd><p>Compute the electrostatic energy after electrosatic forces is
calculated.</p>
<p>From the definition of the elecrostatic potential <span class="math notranslate nohighlight">\(\Psi\)</span>, the energy
is</p>
<blockquote>
<div><dl class="simple">
<dt>W = frac{1}{2}intmathrm{d}mathbf{r},</dt><dd><p>epsilon(mathbf{r})} left(mathbf{E}cdot mathbf{E}right),</p>
</dd>
</dl>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(\epsilon(\mathbf{r})}\)</span> is the anisotropic, spatially dependent,
relative dielectric of the simulation medium.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>config</strong><span class="classifier">hymd.input_parser.Config</span></dt><dd><p>Configuration object.</p>
</dd>
<dt><strong>phi_eps</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing calculated discretized
relative dielectric values on the computational grid.
Local for each MPI rank–the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>field_q_energy</strong><span class="classifier">float</span></dt><dd><p>Total elecrostatic energy.</p>
</dd>
<dt><strong>dot_elec</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing <span class="math notranslate nohighlight">\(|\mathbf{E(r)}|^{2}\)</span>
on the computational grid. Local for each MPI rank – the full computational
grid is represented by the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm</span></dt><dd><p>MPI communicator to use  for rank commuication.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.field.update_field_force_q_GPE" title="hymd.field.update_field_force_q_GPE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_field_force_q_GPE</span></code></a></dt><dd><p>Compute the electrosatic force from an anisotropic dielectric general Poisson equation.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.field.compute_field_force">
<span class="sig-prename descclassname"><span class="pre">hymd.field.</span></span><span class="sig-name descname"><span class="pre">compute_field_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_types</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/field.html#compute_field_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.field.compute_field_force" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate particle-field forces from the grid onto particle positions</p>
<p>Backmaps the forces calculated on the grid to particle positions using the
window function <span class="math notranslate nohighlight">\(P\)</span> (by default cloud-in-cell [CIC]). In the
following, let <span class="math notranslate nohighlight">\(\mathbf{F}_j\)</span> denote the force acting on the
particle with index <span class="math notranslate nohighlight">\(j\)</span> and position <span class="math notranslate nohighlight">\(\mathbf{r}_j\)</span>. The
interpolated force is</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_j = -\sum_k\nabla V_{j_k}
    P(\mathbf{r}_{j_k}-\mathbf{r}_j)h^3,\]</div>
<p>where <span class="math notranslate nohighlight">\(V_{j_k}\)</span> is the discretized external potential at grid vertex
<span class="math notranslate nohighlight">\(j_k\)</span>, <span class="math notranslate nohighlight">\(\mathbf{r}_{j_k}\)</span> is the position of the grid vertex
with index <span class="math notranslate nohighlight">\(j_k\)</span>, and <span class="math notranslate nohighlight">\(h^3\)</span> is the volume of each grid voxel.
The sum is taken over all closest neighbour vertices, <span class="math notranslate nohighlight">\(j_k\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>layouts</strong><span class="classifier">list[pmesh.domain.Layout]</span></dt><dd><p>Pmesh communication layout objects for domain decompositions of each
particle type. Used as blueprint by <code class="code docutils literal notranslate"><span class="pre">pmesh.pm.readout</span></code> for
exchange of particle information across MPI ranks as necessary.</p>
</dd>
<dt><strong>r</strong><span class="classifier">(N,D) numpy.ndarray</span></dt><dd><p>Array of positions for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.
Local for each MPI rank.</p>
</dd>
<dt><strong>force_mesh</strong><span class="classifier">list[pmesh.pm.RealField]</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> objects containing discretized particle-field
force density values on the computational grid; <code class="code docutils literal notranslate"><span class="pre">D</span></code> fields in D
dimensions for each particle type. Local for each MPI rank–the full
computational grid is represented by the collective fields of all MPI
ranks.</p>
</dd>
<dt><strong>force</strong><span class="classifier">(N,D) numpy.ndarray</span></dt><dd><p>Array of forces for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions. Local
for each MPI rank.</p>
</dd>
<dt><strong>types</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of type indices for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles. Local for each
MPI rank.</p>
</dd>
<dt><strong>n_types</strong><span class="classifier">int</span></dt><dd><p>Number of different unique types present in the simulation system.
<code class="code docutils literal notranslate"><span class="pre">n_types</span></code> is global, i.e. the same for all MPI ranks even if some
ranks contain zero particles of certain types.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.field.compute_self_energy_q">
<span class="sig-prename descclassname"><span class="pre">hymd.field.</span></span><span class="sig-name descname"><span class="pre">compute_self_energy_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/field.html#compute_self_energy_q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.field.compute_self_energy_q" title="Permalink to this definition"></a></dt>
<dd><p>Compute the self energy for the interaction due to the Ewald scheme
used to compute the electrostatics. The energy is stored in <code class="code docutils literal notranslate"><span class="pre">config</span></code>.</p>
<p>The self interaction energy is given by:</p>
<div class="math notranslate nohighlight">
\[U_{self} = \sqrt{\frac{1}{2\pi\sigma^2}} \sum_{i=1}^{N} q_i^2\]</div>
<p>where <span class="math notranslate nohighlight">\(q_i\)</span> are the charges and <span class="math notranslate nohighlight">\(\sigma\)</span> is the half-width
of the Gaussian filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
<dt><strong>charges</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of particle charge values for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles. Local for each
MPI rank.</p>
</dd>
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm</span></dt><dd><p>MPI communicator to use for rank communication.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>field_q_self_energy</strong><span class="classifier">float</span></dt><dd><p>Electrostatic self energy.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.field.domain_decomposition">
<span class="sig-prename descclassname"><span class="pre">hymd.field.</span></span><span class="sig-name descname"><span class="pre">domain_decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecules=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topol=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/field.html#domain_decomposition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.field.domain_decomposition" title="Permalink to this definition"></a></dt>
<dd><p>Performs domain decomposition</p>
<p>Rearranges the MPI rank memory layout into one that better mimics the PFFT
pencil grid 2D decomposition. As molecules are always required to be fully
contained on a single MPI rank, a perfect decomposition is not always
possible. The best decomposition which leaves the center of mass of all
molecules in their respective correct domains is used, with possible
overlap into neighbouring domains if the spatial extent of any molecule
crosses domain boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>positions</strong><span class="classifier">(N,D) numpy.ndarray</span></dt><dd><p>Array of positions for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.
Local for each MPI rank.</p>
</dd>
<dt><strong>pm</strong><span class="classifier">pmesh.pm.ParticleMesh</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ParticleMesh</span></code> object interfacing to the CIC window
function and the PFFT discrete Fourier transform library.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Variable length argument list containing arrays to include in the
domain decomposition.</p>
</dd>
<dt><strong>molecules</strong><span class="classifier">(N,) numpy.ndarray, optional</span></dt><dd><p>Array of integer molecule affiliation for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.
Global (across all MPI ranks) or local (local indices on this MPI rank
only) may be used, both, without affecting the result.</p>
</dd>
<dt><strong>bonds</strong><span class="classifier">(N,M) numpy.ndarray, optional</span></dt><dd><p>Array of <code class="code docutils literal notranslate"><span class="pre">M</span></code> bonds originating from each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int, optional</span></dt><dd><p>Specify the logging event verbosity of this function.</p>
</dd>
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm</span></dt><dd><p>MPI communicator to use for rank commuication.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Domain decomposed <code class="code docutils literal notranslate"><span class="pre">positions</span></code> and any array specified in</dt><dd></dd>
<dt><code class="code docutils literal notranslate"><span class="pre">*args</span></code>, in addition to <code class="code docutils literal notranslate"><span class="pre">bonds</span></code> and <code class="code docutils literal notranslate"><span class="pre">molecules</span></code> if these</dt><dd></dd>
<dt>arrays were provided as input.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.field.initialize_pm">
<span class="sig-prename descclassname"><span class="pre">hymd.field.</span></span><span class="sig-name descname"><span class="pre">initialize_pm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/field.html#initialize_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.field.initialize_pm" title="Permalink to this definition"></a></dt>
<dd><p>Creates the necessary pmesh objects for pfft operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>pmesh</strong><span class="classifier">module ‘pmesh.pm’</span></dt><dd></dd>
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration dataclass containing simulation metadata and parameters.</p>
</dd>
<dt><strong>comm</strong><span class="classifier">MPI.Intracomm, optional</span></dt><dd><p>MPI communicator to use for rank commuication. Defaults to
MPI.COMM_WORLD.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>pm</strong><span class="classifier">object ‘pmesh.pm.ParticleMesh’</span></dt><dd></dd>
<dt><strong>field_list</strong><span class="classifier">list[pmesh.pm.RealField], (multiple)</span></dt><dd><p>Essential list of pmesh objects required for MD</p>
</dd>
<dt><strong>list_coulomb</strong><span class="classifier">list[pmesh.pm.RealField], (multiple)</span></dt><dd><p>Additional list of pmesh objects required for electrostatics.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.field.update_field">
<span class="sig-prename descclassname"><span class="pre">hymd.field.</span></span><span class="sig-name descname"><span class="pre">update_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_laplacian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_transfer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_ext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_fourier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_ext_fourier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_potential</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/field.html#update_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.field.update_field" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the particle-field potential and force density</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">compute_potential</span></code> is <code class="code docutils literal notranslate"><span class="pre">True</span></code>, the energy may subsequently
be computed by calling <code class="code docutils literal notranslate"><span class="pre">compute_field_and_kinetic_energy</span></code>.</p>
<p>Computes the particle-field external potential <span class="math notranslate nohighlight">\(V_\text{ext}\)</span> from
particle number densities through the smoothed density field,
<span class="math notranslate nohighlight">\(\phi(\mathbf{r})\)</span>. With <span class="math notranslate nohighlight">\(P\)</span> being the cloud-in-cell (CIC)
window function, the density and filtered densities are computed as</p>
<div class="math notranslate nohighlight">
\[\phi(\mathbf{r}) = \sum_i P(\mathbf{r}-\mathbf{r}_i),\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\tilde\phi(\mathbf{r}) = \int\mathrm{x}\mathbf{r}\,
    \phi(\mathbf{x})H(\mathbf{r}-\mathbf{x}),\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the grid-independent filtering function. The
external potential is computed in reciprocal space as</p>
<div class="math notranslate nohighlight">
\[V_\text{ext} = \mathrm{FFT}^{-1}\left[
    \mathrm{FFT}
        \left(
            \frac{\partial w}{\partial \tilde\phi}
        \right)
    \mathrm{FFT}(H)
\right],\]</div>
<p>where <span class="math notranslate nohighlight">\(w\)</span> is the interaction energy functional. Differentiating
<span class="math notranslate nohighlight">\(V_\text{ext}\)</span> is done by simply applying <span class="math notranslate nohighlight">\(i\mathbf{k}\)</span> in
Fourier space, and the resulting forces are back-transformed to direct
space and interpolated to particle positions by</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_j = -\sum_{j_k} \nabla V_{j_k}
    P(\mathbf{r}_{j_k} - \mathbf{r}_j)h^3,\]</div>
<p>where <span class="math notranslate nohighlight">\(j_k\)</span> are the neighbouring vertices of particle <span class="math notranslate nohighlight">\(j\)</span> at
position <span class="math notranslate nohighlight">\(\mathbf{r}_j\)</span>, and <span class="math notranslate nohighlight">\(h^3\)</span> is the volume of each grid
voxel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>phi</strong><span class="classifier">list[pmesh.pm.RealField]</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> objects containing discretized particle number
density values on the computational grid; one for each particle type.
Pre-allocated, but empty; any values in this field are discarded.
Changed in-place. Local for each MPI rank–the full computational grid
is represented by the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>phi_laplacian</strong><span class="classifier">list[pmesh.pm.RealField], (M, 3)</span></dt><dd><p>Like phi, but containing the laplacian of particle number densities.</p>
</dd>
<dt><strong>phi_transfer</strong><span class="classifier">list[pmesh.pm.ComplexField], (3,)</span></dt><dd><p>Like phi_fourier, used as an intermediary to perform FFT operations
to obtain the gradient or laplacian of particle number densities.</p>
</dd>
<dt><strong>layouts</strong><span class="classifier">list[pmesh.domain.Layout]</span></dt><dd><p>Pmesh communication layout objects for domain decompositions of each
particle type. Used as blueprint by <code class="code docutils literal notranslate"><span class="pre">pmesh.pm.readout</span></code> for
exchange of particle information across MPI ranks as necessary.</p>
</dd>
<dt><strong>force_mesh</strong><span class="classifier">list[pmesh.pm.RealField]</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> objects containing discretized particle-field
force density values on the computational grid; <code class="code docutils literal notranslate"><span class="pre">D</span></code> fields in D
dimensions for each particle type. Pre-allocated, but empty; any values
in this field are discarded. Changed in-place. Local for each MPI
rank–the full computational grid is represented by the collective
fields of all MPI ranks.</p>
</dd>
<dt><strong>hamiltonian</strong><span class="classifier">Hamiltonian</span></dt><dd><p>Particle-field interaction energy handler object. Defines the
grid-independent filtering function, <span class="math notranslate nohighlight">\(H\)</span>.</p>
</dd>
<dt><strong>pm</strong><span class="classifier">pmesh.pm.ParticleMesh</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ParticleMesh</span></code> object interfacing to the CIC window
function and the PFFT discrete Fourier transform library.</p>
</dd>
<dt><strong>positions</strong><span class="classifier">(N,D) numpy.ndarray</span></dt><dd><p>Array of positions for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.
Local for each MPI rank.</p>
</dd>
<dt><strong>types</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of type indices for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles. Local for each
MPI rank.</p>
</dd>
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
<dt><strong>v_ext</strong><span class="classifier">list[pmesh.pm.RealField]</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> objects containing discretized particle-field
external potential values on the computational grid; one for each
particle type. Pre-allocated, but empty; any values in this field are
discarded Changed in-place. Local for each MPI rank–the full
computational grid is represented by the collective fields of all MPI
ranks.</p>
</dd>
<dt><strong>phi_fourier</strong><span class="classifier">list[pmesh.pm.ComplexField]</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ComplexField</span></code> objects containing discretized particle
number density values in reciprocal space on the computational grid;
one for each particle type. Pre-allocated, but empty; any values in
this field are discarded Changed in-place. Local for each MPI rank–the
full computational grid is represented by the collective fields of all
MPI ranks.</p>
</dd>
<dt><strong>v_ext_fourier</strong><span class="classifier">list[pmesh.pm.ComplexField]</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ComplesField</span></code> objects containing discretized
particle-field external potential values in reciprocal space on the
computational grid; <code class="code docutils literal notranslate"><span class="pre">D+1</span></code> fields in D dimensions for each
particle type. <code class="code docutils literal notranslate"><span class="pre">D</span></code> copies are made after calculation for later
use in force calculation, because the <cite>force transfer function</cite>
application differentiates the field in-place, ruining the contents
for differentiation in the remaining <code class="code docutils literal notranslate"><span class="pre">D-1</span></code> spatial directions.
Pre-allocated, but empty; any values in this field are discarded.
Changed in-place. Local for each MPI rank–the full computational grid
is represented by the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>m: list[float], (M,)</strong></dt><dd><p>pmesh.pm.ParticleMesh parameter for mass of particles in simulation unit.
Defaults to 1.0 for all particle types.</p>
</dd>
<dt><strong>compute_potential</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, a <code class="code docutils literal notranslate"><span class="pre">D+1</span></code>-th copy of the Fourier transformed
external potential field is made to be used later in particle-field
energy calculation. If <code class="code docutils literal notranslate"><span class="pre">False</span></code>, only <code class="code docutils literal notranslate"><span class="pre">D</span></code> copies are made.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.field.compute_field_and_kinetic_energy" title="hymd.field.compute_field_and_kinetic_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_field_and_kinetic_energy</span></code></a></dt><dd><p>Compute the particle-field energy after the external potential is calculated.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.field.update_field_force_q">
<span class="sig-prename descclassname"><span class="pre">hymd.field.</span></span><span class="sig-name descname"><span class="pre">update_field_force_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_q_fourier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi_fourier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_field_fourier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_forces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/field.html#update_field_force_q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.field.update_field_force_q" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the electrostatic particle-field forces on the grid</p>
<p>Computes the electrostatic potential <span class="math notranslate nohighlight">\(\Psi\)</span> from particle charges
through the smoothed charge density <span class="math notranslate nohighlight">\(\tilde\rho\)</span>. With <span class="math notranslate nohighlight">\(P\)</span>
being the cloud-in-cell (CIC) window function, the charge density and
filtered charge densities are computed as</p>
<div class="math notranslate nohighlight">
\[\rho(\mathbf{r}) = \sum_i q_i P(\mathbf{r}-\mathbf{r}_i),\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\tilde\rho(\mathbf{r}) = \int\mathrm{x}\mathbf{r}\,
    \rho(\mathbf{x})H(\mathbf{r}-\mathbf{x}),\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the grid-independent filtering function. The
electrostatic potential is computed in reciprocal space as</p>
<div class="math notranslate nohighlight">
\[\Phi = \mathrm{FFT}^{-1}\left[
    \frac{4\pi k_e}{\varepsilon \vert\mathbf{k}\vert^2}
    \mathrm{FFT}(\rho)\mathrm{FFT}(H)
\right],\]</div>
<p>with the electric field</p>
<div class="math notranslate nohighlight">
\[\mathbf{E} = \mathrm{FFT}^{-1}\left[
    -i\mathbf{k}\,\mathrm{FFT}(\Psi)
\right].\]</div>
<p>In the following, let <span class="math notranslate nohighlight">\(\mathbf{F}_j\)</span> denote the electrostatic force
acting on the particle with index <span class="math notranslate nohighlight">\(j\)</span> and position
<span class="math notranslate nohighlight">\(\mathbf{r}_j\)</span>. The interpolated electrostatic force is</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_j = \sum_k q_j\mathbf{E}_{j_k}
    P(\mathbf{r}_{j_k}-\mathbf{r}_j)h^3,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{E}_{j_k}\)</span> is the discretized electric field at grid
vertex <span class="math notranslate nohighlight">\(j_k\)</span>, <span class="math notranslate nohighlight">\(\mathbf{r}_{j_k}\)</span> is the position of the grid
vertex with index <span class="math notranslate nohighlight">\(j_k\)</span>, and <span class="math notranslate nohighlight">\(h^3\)</span> is the volume of each grid
voxel. The sum is taken over all closest neighbour vertices, <span class="math notranslate nohighlight">\(j_k\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>charges</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of particle charge values for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles. Local for each
MPI rank.</p>
</dd>
<dt><strong>phi_q</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing calculated discretized
charge density density values on the computational grid. Pre-allocated,
but empty; any values in this field are discarded. Changed in-place.
Local for each MPI rank–the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>phi_q_fourier</strong><span class="classifier">pmesh.pm.ComplexField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ComplexField</span></code> object for storing calculated discretized
Fourier transformed charge density values in reciprocal space on the
computational grid. Pre-allocated, but empty; any values in this field
are discarded. Changed in-place. Local for each MPI rank–the full
computational grid is represented by the collective fields of all MPI
ranks.</p>
</dd>
<dt><strong>elec_field_fourier</strong><span class="classifier">pmesh.pm.ComplexField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ComplexField</span></code> object for storing calculated discretized
electric field values in reciprocal space on the computational grid.
Pre-allocated, but empty; any values in this field are discarded.
Changed in-place. Local for each MPI rank–the full computational grid
is represented by the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>elec_field</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing calculated discretized
electric field values on the computational grid. Pre-allocated,
but empty; any values in this field are discarded. Changed in-place.
Local for each MPI rank–the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>elec_forces</strong><span class="classifier">(N,D) numpy.ndarray</span></dt><dd><p>Array of electrostatic forces on <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code>
dimensions.</p>
</dd>
<dt><strong>layout_q</strong><span class="classifier">pmesh.domain.Layout</span></dt><dd><p>Pmesh communication layout object for domain decomposition of the full
system. Used as blueprint by <code class="code docutils literal notranslate"><span class="pre">pmesh.pm.paint</span></code> and
<code class="code docutils literal notranslate"><span class="pre">pmesh.pm.readout</span></code> for exchange of particle information across
MPI ranks as necessary.</p>
</dd>
<dt><strong>hamiltonian</strong><span class="classifier">Hamiltonian</span></dt><dd><p>Particle-field interaction energy handler object. Defines the
grid-independent filtering function, <span class="math notranslate nohighlight">\(H\)</span>.</p>
</dd>
<dt><strong>pm</strong><span class="classifier">pmesh.pm.ParticleMesh</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ParticleMesh</span></code> object interfacing to the CIC window
function and the PFFT discrete Fourier transform library.</p>
</dd>
<dt><strong>positions</strong><span class="classifier">(N,D) numpy.ndarray</span></dt><dd><p>Array of positions for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.
Local for each MPI rank.</p>
</dd>
<dt><strong>config</strong><span class="classifier">hymd.input_parser.Config</span></dt><dd><p>Configuration object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.field.update_field_force_q_GPE">
<span class="sig-prename descclassname"><span class="pre">hymd.field.</span></span><span class="sig-name descname"><span class="pre">update_field_force_q_GPE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conv_fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_q_fourier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_eps_fourier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_eta_fourier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_pol_prev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_pol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_forces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_field_contrib</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vbar_elec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vbar_elec_fourier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_mesh_elec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_mesh_elec_fourier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/field.html#update_field_force_q_GPE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.field.update_field_force_q_GPE" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the electrostatic particle-field forces on the grid, arising from
a general Poisson equation, i.e. anisotropic permittivity/dielectric.
The function is called when tomli input config.coulombtype = “PIC_Spectral_GPE.”</p>
<p>Computes the electrostatic potential <span class="math notranslate nohighlight">\(\Psi\)</span> from particle charges
through the smoothed charge density <span class="math notranslate nohighlight">\(\tilde\rho\)</span>. With <span class="math notranslate nohighlight">\(P\)</span>
being the cloud-in-cell (CIC) window function, the charge density and
filtered charge densities are computed as</p>
<div class="math notranslate nohighlight">
\[\rho(\mathbf{r}) = \sum_i q_i P(\mathbf{r}-\mathbf{r}_i),\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\tilde\rho(\mathbf{r}) = \int\mathrm{x}\mathbf{r}\,
    \rho(\mathbf{x})H(\mathbf{r}-\mathbf{x}),\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the grid-independent filtering function. The
electrostatic potential for a variable dielectric does not have an
analytical expression, and is computed in reciprocal through an iterative
method.</p>
<p>The GPE states that</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \left(\epsilon(\mathbf{r})
\nabla{\mathbf{\psi(r)}}\right) = -\rho({\mathbf{r}}).\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon(\mathbf{r})\)</span> is the relative dielectric function.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>conv_fun</strong><span class="classifier">Convergence function.</span></dt><dd><p>Returns a scalar. Depends on MPI allreduce for similar convergence
across MPI ranks.</p>
</dd>
<dt><strong>phi</strong><span class="classifier">list[pmesh.pm.RealField]</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> objects containing discretized particle number
density values on the computational grid; one for each particle type.
Local for each MPI rank–the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>types</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of type indices for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles. Local for each
MPI rank.</p>
</dd>
<dt><strong>charges</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of particle charge values for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles. Local for each
MPI rank.</p>
</dd>
<dt><strong>phi_q</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing calculated discretized
charge density density values on the computational grid. Pre-allocated,
but empty. Changed in-place.
Local for each MPI rank–the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>phi_q_fourier</strong><span class="classifier">pmesh.pm.ComplexField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ComplexField</span></code> object for storing calculated discretized
Fourier transformed charge density values in reciprocal space on the
computational grid. Pre-allocated, but empty. Changed in-place.
Local for each MPI rank–the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>phi_eps</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing calculated discretized
relative dielectric values on the computational grid. Pre-allocated,
but empty. Changed in-place.
Local for each MPI rank–the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>phi_eps_fourier</strong><span class="classifier">pmesh.pm.ComplexField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ComplexField</span></code> object for storing calculated discretized
Fourier transformed relative dielectric values in reciprocal space on the
computational grid. Pre-allocated, but empty. Changed in-place.
Local for each MPI rank–the full computational grid is represented
by the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>phi_eta</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing calculated discretized
gradients of the relative dielectric values on the computational grid.
Pre-allocated,but empty. Changed in-place.Local for each MPI rank–the
full computational grid is represented by the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>phi_eta_fourier</strong><span class="classifier">pmesh.pm.ComplexField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ComplexField</span></code> object for storing the calculated discretized
Fourier transformed gradient relative dielectric values in reciprocal space on the
computational grid. Pre-allocated, but empty.  Changed in-place.
Local for each MPI rank–the full computational grid is represented
by the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>phi_pol_prev</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing calculated discretized
polarization charge values on the computational grid. Parameter in
the iterative method.Pre-allocated,but empty. Changedin-place.
Local for each MPI rank–the full computational grid is represented
by the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>phi_pol</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing calculated discretized
polarization charges on the computational grid. Parameter in the iterative
method, updating the next quess in solving for the electrostatic potential.
Pre-allocated,but empty.  Changed in-place.Local for each MPI rank–
the full computational grid is represented by the collective fields of
all MPI ranks.</p>
</dd>
<dt><strong>elec_field</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing calculated discretized
electric field values on the computational grid. Pre-allocated,
but empty. Changed in-place. Local for each MPI rank–the full
computational grid is represented by the collective fields of all
MPI ranks.</p>
</dd>
<dt><strong>elec_forces</strong><span class="classifier">(N,D) numpy.ndarray</span></dt><dd><p>Array of electrostatic forces on <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code>
dimensions.</p>
</dd>
<dt><strong>elec_field_contrib</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing
<span class="math notranslate nohighlight">\(|\mathbf{E(r)}|^2/\phi_{0}\)</span> on the computational grid.
Pre-allocated, but empty. Changed in-place.
Local for each MPI rank– the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>psi</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing electrostatic potential
on the computational grid. Pre-allocated, but empty. Changed in-place.
Local for each MPI rank– the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>Vbar_elec</strong><span class="classifier">mesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing functional derivatives of
:math:<a href="#id1"><span class="problematic" id="id2">`</span></a>|w({ phi })_{elec}`on the computational grid.
Pre-allocated, but empty. Changed in-place. Local for each MPI rank–
the full computational grid is represented by the collective fields of</p>
<blockquote>
<div><p>all MPI ranks.</p>
</div></blockquote>
</dd>
<dt><strong>Vbar_elec_fourier</strong><span class="classifier">pmesh.pm.ComplexField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ComplexField</span></code> object for storing the calculated functional
derivatives of <span class="math notranslate nohighlight">\(\|w(\{ \phi \})_{elec}\)</span> in reciprocal space on the
computational grid. Pre-allocated, but empty.  Changed in-place.
Local for each MPI rank–the full computational grid is represented
by the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>force_mesh_elec</strong><span class="classifier">pmesh.pm.RealField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">RealField</span></code> object for storing electrostatic force values
on the computational grid. Pre-allocated, but empty. Changed in-place.
Local for each MPI rank– the full computational grid is represented by
the collective fields of all MPI ranks.</p>
</dd>
<dt><strong>force_mesh_elec_fourier</strong><span class="classifier">pmesh.pm.ComplexField</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ComplexField</span></code> object for storing the calculated electrostatic
force values in reciprocal space on the computational grid. Local for
each MPI rank–the full computational grid is represented by the collective
fields of all MPI ranks.</p>
</dd>
<dt><strong>hamiltonian</strong><span class="classifier">Hamiltonian</span></dt><dd><p>Particle-field interaction energy handler object. Defines the
grid-independent filtering function, <span class="math notranslate nohighlight">\(H\)</span>.</p>
</dd>
<dt><strong>layout_q</strong><span class="classifier">pmesh.domain.Layout</span></dt><dd><p>Pmesh communication layout object for domain decomposition of the full
system. Used as blueprint by <code class="code docutils literal notranslate"><span class="pre">pmesh.pm.paint</span></code> and
<code class="code docutils literal notranslate"><span class="pre">pmesh.pm.readout</span></code> for exchange of particle information across
MPI ranks as necessary.</p>
</dd>
<dt><strong>layouts: list[pmesh.domain.Layout]</strong></dt><dd><p>Pmesh communication layout objects for domain decompositions of each
particle type. Used as blueprint by <code class="code docutils literal notranslate"><span class="pre">pmesh.pm.readout</span></code> for
exchange of particle information across MPI ranks as necessary.</p>
</dd>
<dt><strong>pm</strong><span class="classifier">pmesh.pm.ParticleMesh</span></dt><dd><p>Pmesh <code class="code docutils literal notranslate"><span class="pre">ParticleMesh</span></code> object interfacing to the CIC window
function and the PFFT discrete Fourier transform library.</p>
</dd>
<dt><strong>positions</strong><span class="classifier">(N,D) numpy.ndarray</span></dt><dd><p>Array of positions for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.
Local for each MPI rank.</p>
</dd>
<dt><strong>config</strong><span class="classifier">hymd.input_parser.Config</span></dt><dd><p>Configuration object.</p>
</dd>
<dt><strong>comm: mpi4py.Comm</strong></dt><dd><p>MPI communicator to use for rank commuication.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.field.compute_field_energy_q_GPE" title="hymd.field.compute_field_energy_q_GPE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_field_energy_q_GPE</span></code></a></dt><dd><p>Compute the electrostatic energy after electrosatic force is calculated for a variable (anisotropic) dielectric general Poisson equation.</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
<section id="module-hymd.file_io">
<span id="file-input-output"></span><h2><span class="section-number">4.8. </span>File input/output<a class="headerlink" href="#module-hymd.file_io" title="Permalink to this heading"></a></h2>
<p>Handle file input/output in parllel HDF5 fashion</p>
<dl class="py class">
<dt class="sig sig-object py" id="hymd.file_io.OutDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hymd.file_io.</span></span><span class="sig-name descname"><span class="pre">OutDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double_out=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_mpio=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/file_io.html#OutDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.file_io.OutDataset" title="Permalink to this definition"></a></dt>
<dd><p>HDF5 dataset handler for file output</p>
<dl class="py method">
<dt class="sig sig-object py" id="hymd.file_io.OutDataset.close_file">
<span class="sig-name descname"><span class="pre">close_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/file_io.html#OutDataset.close_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.file_io.OutDataset.close_file" title="Permalink to this definition"></a></dt>
<dd><p>Closes the HDF5 output file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm</span></dt><dd><p>MPI communicator to use for rank communication.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hymd.file_io.OutDataset.flush">
<span class="sig-name descname"><span class="pre">flush</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/file_io.html#OutDataset.flush"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.file_io.OutDataset.flush" title="Permalink to this definition"></a></dt>
<dd><p>Flushes output buffers, forcing file writes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hymd.file_io.OutDataset.is_open">
<span class="sig-name descname"><span class="pre">is_open</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/file_io.html#OutDataset.is_open"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.file_io.OutDataset.is_open" title="Permalink to this definition"></a></dt>
<dd><p>Check if HDF5 output file is open</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm</span></dt><dd><p>MPI communicator to use for rank communication.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.file_io.distribute_input">
<span class="sig-prename descclassname"><span class="pre">hymd.file_io.</span></span><span class="sig-name descname"><span class="pre">distribute_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_molecule_size=201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/file_io.html#distribute_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.file_io.distribute_input" title="Permalink to this definition"></a></dt>
<dd><p>Assign global arrays onto MPI ranks, attempting load balancing</p>
<p>Distributes approximately equal numbers of particles (workload) onto each
independent MPI rank, while respecting the requirement that any molecule
must be fully contained on a single MPI rank only (no splitting molecules
across multiple CPUs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>in_file</strong><span class="classifier">h5py.File</span></dt><dd><p>HDF5 input file object.</p>
</dd>
<dt><strong>rank</strong><span class="classifier">int</span></dt><dd><p>Local rank number for this MPI rank.</p>
</dd>
<dt><strong>size</strong><span class="classifier">int</span></dt><dd><p>Global size of the MPI communicator (number of total CPUs).</p>
</dd>
<dt><strong>n_particles</strong><span class="classifier">int</span></dt><dd><p>Total number of particles.</p>
</dd>
<dt><strong>max_molecule_size</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum size of any molecule present in the system. Used to initially
guess where the MPI rank boundaries (start/end indices) in the global
arrays should be placed. If molecules of size
<code class="code docutils literal notranslate"><span class="pre">&gt;max_molecule_size</span></code> exist in the simulation system, HyMD
<strong>might</strong> work as expected. Or it might fail spectacularly.</p>
</dd>
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm</span></dt><dd><p>MPI communicator to use for rank commuication.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>rank_range</dt><dd><p>Starting and ending indices in the global arrays for each MPI rank.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.file_io.setup_time_dependent_element">
<span class="sig-prename descclassname"><span class="pre">hymd.file_io.</span></span><span class="sig-name descname"><span class="pre">setup_time_dependent_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/file_io.html#setup_time_dependent_element"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.file_io.setup_time_dependent_element" title="Permalink to this definition"></a></dt>
<dd><p>Helper function for setting up time-dependent HDF5 group datasets</p>
<p>All output groups must adhere to the H5MD standard, meaning a structure of</p>
<div class="line-block">
<div class="line">┗━ <strong>group</strong> particle group (e.g. <code class="code docutils literal notranslate"><span class="pre">all</span></code>) or <code class="code docutils literal notranslate"><span class="pre">observables</span></code> group</div>
<div class="line-block">
<div class="line">┗━ <strong>group</strong> time-dependent data</div>
<div class="line-block">
<div class="line">┣━ <strong>dataset</strong> <code class="code docutils literal notranslate"><span class="pre">step</span></code> <code class="code docutils literal notranslate"><span class="pre">shape=(n_frames,)</span></code></div>
<div class="line">┣━ <strong>dataset</strong> <code class="code docutils literal notranslate"><span class="pre">time</span></code> <code class="code docutils literal notranslate"><span class="pre">shape=(n_frames,)</span></code></div>
<div class="line">┗━ <strong>dataset</strong> <code class="code docutils literal notranslate"><span class="pre">value</span></code> <code class="code docutils literal notranslate"><span class="pre">shape=(n_frames,</span> <span class="pre">*)</span></code></div>
</div>
</div>
</div>
<p>is necessary.</p>
<p class="rubric">References</p>
<dl class="simple">
<dt>H5MD specification :</dt><dd><p><a class="reference external" href="https://www.nongnu.org/h5md/h5md.html">https://www.nongnu.org/h5md/h5md.html</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.file_io.store_data">
<span class="sig-prename descclassname"><span class="pre">hymd.file_io.</span></span><span class="sig-name descname"><span class="pre">store_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5md</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kinetic_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond2_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond3_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond4_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_q_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plumed_bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_out=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_out=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge_out=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plumed_out=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_per_particle=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/file_io.html#store_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.file_io.store_data" title="Permalink to this definition"></a></dt>
<dd><p>Writes time-step data to HDF5 output file</p>
<p>Handles all quantities which change during simulation, as opposed to
static quanitities (see <code class="code docutils literal notranslate"><span class="pre">store_static</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>h5md</strong><span class="classifier">OutDataset</span></dt><dd><p>HDF5 dataset handler.</p>
</dd>
<dt><strong>step</strong><span class="classifier">int</span></dt><dd><p>Step number.</p>
</dd>
<dt><strong>frame</strong><span class="classifier">int</span></dt><dd><p>Output frame number (<code class="code docutils literal notranslate"><span class="pre">step</span> <span class="pre">//</span> <span class="pre">n_print</span></code>).</p>
</dd>
<dt><strong>indices</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of indices for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>positions</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of positions for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.</p>
</dd>
<dt><strong>velocities</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of velocities for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.</p>
</dd>
<dt><strong>forces</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of forces for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles in <code class="code docutils literal notranslate"><span class="pre">D</span></code> dimensions.</p>
</dd>
<dt><strong>box_size</strong><span class="classifier">(D,) numpy.ndarray</span></dt><dd><p>Array containing the simulation box size.</p>
</dd>
<dt><strong>temperature</strong><span class="classifier">float</span></dt><dd><p>Calculated instantaneous temperature.</p>
</dd>
<dt><strong>kinetic_energy</strong><span class="classifier">float</span></dt><dd><p>Calculated instantaneous kinetic energy.</p>
</dd>
<dt><strong>bond2_energy</strong><span class="classifier">float</span></dt><dd><p>Calculated instantaneous harmonic two-particle bond energy.</p>
</dd>
<dt><strong>bond3_energy</strong><span class="classifier">float</span></dt><dd><p>Calculated instantaneous harmonic angular three-particle bond energy.</p>
</dd>
<dt><strong>bond4_energy</strong><span class="classifier">float</span></dt><dd><p>Calculated instantaneous dihedral four-particle torsion energy.</p>
</dd>
<dt><strong>field_energy</strong><span class="classifier">float</span></dt><dd><p>Calculated instantaneous particle-field energy.</p>
</dd>
<dt><strong>field_q_energy</strong><span class="classifier">float</span></dt><dd><p>Calculated instantaneous electrostatic energy.</p>
</dd>
<dt><strong>plumed_bias</strong><span class="classifier">float</span></dt><dd><p>PLUMED instantaneous bias energy.</p>
</dd>
<dt><strong>time_step</strong><span class="classifier">float</span></dt><dd><p>Value of the time step.</p>
</dd>
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
<dt><strong>velocity_out</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, velocities are written to output HDF5 file.</p>
</dd>
<dt><strong>force_out</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, forces are written to output HDF5 file.</p>
</dd>
<dt><strong>charge_out</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, electrostatic energies are written to the output
HDF5 file.</p>
</dd>
<dt><strong>plumed_out</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, PLUMED bias is written to the output HDF5 file.</p>
</dd>
<dt><strong>dump_per_particle</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, all quantities are written <strong>per particle</strong>.</p>
</dd>
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm</span></dt><dd><p>MPI communicator to use for rank commuication.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#hymd.file_io.store_static" title="hymd.file_io.store_static"><code class="xref py py-obj docutils literal notranslate"><span class="pre">store_static</span></code></a></dt><dd><p>Outputs all static time-independent quantities to the HDF5 output file</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hymd.file_io.store_static">
<span class="sig-prename descclassname"><span class="pre">hymd.file_io.</span></span><span class="sig-name descname"><span class="pre">store_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5md</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_2_atom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_2_atom2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecules=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_out=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_out=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dielectrics=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plumed_out=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hymd/file_io.html#store_static"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hymd.file_io.store_static" title="Permalink to this definition"></a></dt>
<dd><p>Outputs all static time-independent quantities to the HDF5 output file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>h5md</strong><span class="classifier">OutDataset</span></dt><dd><p>HDF5 dataset handler.</p>
</dd>
<dt><strong>rank_range</strong><span class="classifier">list[int]</span></dt><dd><p>Start and end indices for global arrays for each MPI rank.</p>
</dd>
<dt><strong>names</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of names for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>types</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of type indices for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>indices</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of indices for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>config</strong><span class="classifier">Config</span></dt><dd><p>Configuration object.</p>
</dd>
<dt><strong>bonds_2_atom1</strong><span class="classifier">(B,) numpy.ndarray</span></dt><dd><p>Array of indices of the first particle for <code class="code docutils literal notranslate"><span class="pre">B</span></code> total
two-particle bonds.</p>
</dd>
<dt><strong>bonds_2_atom2</strong><span class="classifier">(B,) numpy.ndarray</span></dt><dd><p>Array of indices of the second particle for <code class="code docutils literal notranslate"><span class="pre">B</span></code> total
two-particle bonds.</p>
</dd>
<dt><strong>molecules</strong><span class="classifier">(N,) numpy.ndarray, optional</span></dt><dd><p>Array of integer molecule affiliation for each of <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.
Global (across all MPI ranks) or local (local indices on this MPI rank
only) may be used, both, without affecting the result.</p>
</dd>
<dt><strong>velocity_out</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, velocities are written to output HDF5 file.</p>
</dd>
<dt><strong>force_out</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, forces are written to output HDF5 file.</p>
</dd>
<dt><strong>charges</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of particle charge values for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>dielectrics</strong><span class="classifier">(N,) numpy.ndarray</span></dt><dd><p>Array of particle relative dielectric values for <code class="code docutils literal notranslate"><span class="pre">N</span></code> particles.</p>
</dd>
<dt><strong>plumed_out</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code>, PLUMED bias is written to output HDF5 file.</p>
</dd>
<dt><strong>comm</strong><span class="classifier">mpi4py.Comm</span></dt><dd><p>MPI communicator to use for rank commuication.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_bonds</span></code></dt><dd><p>Constructs two-, three-, and four-particle bonds from toplogy input file and bond configuration information.</p>
</dd>
<dt><a class="reference internal" href="#hymd.file_io.distribute_input" title="hymd.file_io.distribute_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distribute_input</span></code></a></dt><dd><p>Distributes input arrays onto MPI ranks, attempting load balancing.</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="benchmarks.html" class="btn btn-neutral float-left" title="3. Benchmarks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Morten Ledum, Xinmeng Li, Samiran Sen, Manuel Carrer, Sigbjørn Løland Bore.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v1.0.7
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Releases</dt>
      <dd><a href="../../v1.0.1/doc_pages/api.html">v1.0.1</a></dd>
      <dd><a href="../../v1.0.2/doc_pages/api.html">v1.0.2</a></dd>
      <dd><a href="../../v1.0.3/doc_pages/api.html">v1.0.3</a></dd>
      <dd><a href="../../v1.0.4/doc_pages/api.html">v1.0.4</a></dd>
      <dd><a href="../../v1.0.5/doc_pages/api.html">v1.0.5</a></dd>
      <dd><a href="../../v1.0.6/doc_pages/api.html">v1.0.6</a></dd>
      <dd><a href="api.html">v1.0.7</a></dd>
      <dd><a href="../../v1.0.8/doc_pages/api.html">v1.0.8</a></dd>
      <dd><a href="../../v1.0.9/doc_pages/api.html">v1.0.9</a></dd>
      <dd><a href="../../v2.0.0/doc_pages/api.html">v2.0.0</a></dd>
      <dd><a href="../../v2.0.1/doc_pages/api.html">v2.0.1</a></dd>
      <dd><a href="../../v2.0.2/doc_pages/api.html">v2.0.2</a></dd>
      <dd><a href="../../v2.1.0/doc_pages/api.html">v2.1.0</a></dd>
      <dd><a href="../../v2.2.0/doc_pages/api.html">v2.2.0</a></dd>
    </dl>
    <dl>
      <dt>Development</dt>
      <dd><a href="../../main/doc_pages/api.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>