<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Examples &mdash; hymd 1.0.8 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css?v=995e94df" />
      <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.min.css?v=21c0b90a" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=9ae11f4d" />

  
    <link rel="shortcut icon" href="../_static/hymd_icon_white.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=8cbfd27f"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1. Theory" href="theory.html" />
    <link rel="prev" title="6. Constants and Units" href="constants_and_units.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/hymd_logl_white_text_abbr.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0.8
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#dependencies">1.1. Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-hymd">1.2. Installing HyMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#install-in-docker">1.3. Install in docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#run-interactively-in-google-colaboratory">1.4. Run interactively in Google Colaboratory</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#common-issues">1.5. Common issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#numpy-errors-while-importing-the-fortran-force-kernels">1.5.1. Numpy errors while importing the Fortran force kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#error-building-pfft-python-due-to-missing-curl-wget">1.5.2. Error building pfft-python due to missing curl/wget</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#error-running-parallel-hymd-without-mpi-enabled-h5py">1.5.3. Error running parallel HyMD without MPI-enabled h5py</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">2. Usage overview for HylleraasMD</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#running-parallel-simulations">2.1. Running parallel simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#running-tests">2.2. Running tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config_file.html">3. Configuration file</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config_file.html#configuration-file-keywords">3.1. Configuration file keywords</a><ul>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#metadata-keywords">3.1.1. Metadata keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#particle-keywords">3.1.2. Particle keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#simulation-keywords">3.1.3. Simulation keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#field-keywords">3.1.4. Field keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#bond-keywords">3.1.5. Bond keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_file.html#electrostatic-keywords">3.1.6. Electrostatic keywords</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="topology_input.html">4. Topology and structure file</a><ul>
<li class="toctree-l2"><a class="reference internal" href="topology_input.html#required-datasets">4.1. Required datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="topology_input.html#optional-datasets">4.2. Optional datasets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">5. Command line arguments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="command_line.html#required-arguments">5.1. Required arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="command_line.html#optional-arguments">5.2. Optional arguments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="constants_and_units.html">6. Constants and Units</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ideal-gas">1.1. Ideal gas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ideal-chains">1.2. Ideal chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stiff-rods">1.3. Stiff rods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#helixes">1.4. Helixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#phase-separation">1.5. Phase separation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#diblock-copolymers">1.6. Diblock copolymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lipid-bilayer-self-assembly">1.7. Lipid bilayer self-assembly</a></li>
<li class="toctree-l2"><a class="reference internal" href="#peptide-in-lipid-bilayer">1.8. Peptide in lipid bilayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sds">1.9. SDS</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="theory.html">1. Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="theory.html#external-potential">1.1. External potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#force-interpolation">1.2. Force interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#reciprocal-space-calculations">1.3. Reciprocal space calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#filter">1.4. Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#hamiltonian-form">1.5. Hamiltonian form</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intramolecular_bonds.html">2. Intramolecular bonds</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intramolecular_bonds.html#two-particle-bonds">2.1. Two-particle bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="intramolecular_bonds.html#three-particle-bonds">2.2. Three-particle bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="intramolecular_bonds.html#four-particle-bonds">2.3. Four-particle bonds</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="electrostatics.html">3. Electrostatic interactions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="electrostatics.html#specifying-electrostatics">3.1. Specifying electrostatics</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="interaction_energy_functionals.html">1. Interaction energy functionals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interaction_energy_functionals.html#chi-interaction-and-kappa-incompressibility">1.1. <span class="math notranslate nohighlight">\(\chi\)</span>–interaction and <span class="math notranslate nohighlight">\(\kappa\)</span>–incompressibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="interaction_energy_functionals.html#only-kappa-incompressibility">1.2. Only <span class="math notranslate nohighlight">\(\kappa\)</span>–incompressibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="interaction_energy_functionals.html#only-phi-2">1.3. Only <span class="math notranslate nohighlight">\(\phi^2\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="interaction_energy_functionals.html#implementing-new-interaction-energy-forms">1.4. Implementing new interaction energy forms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="filtering.html">2. Filtering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="filtering.html#implementing-new-filters">2.1. Implementing new filters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">3. Benchmarks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="benchmarks.html#bonded-forces">3.1. Bonded forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmarks.html#particle-field-forces">3.2. Particle–field forces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">4. API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-hymd.integrator">4.1. Integrator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.integrator.integrate_position"><code class="docutils literal notranslate"><span class="pre">integrate_position()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.integrator.integrate_velocity"><code class="docutils literal notranslate"><span class="pre">integrate_velocity()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-hymd.thermostat">4.2. Thermostat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.thermostat._random_chi_squared"><code class="docutils literal notranslate"><span class="pre">_random_chi_squared()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.thermostat._random_gaussian"><code class="docutils literal notranslate"><span class="pre">_random_gaussian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.thermostat.csvr_thermostat"><code class="docutils literal notranslate"><span class="pre">csvr_thermostat()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#hamiltonian">4.3. Hamiltonian</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.hamiltonian.Hamiltonian"><code class="docutils literal notranslate"><span class="pre">Hamiltonian</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.hamiltonian.Hamiltonian.__init__"><code class="docutils literal notranslate"><span class="pre">Hamiltonian.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.hamiltonian.Hamiltonian._setup"><code class="docutils literal notranslate"><span class="pre">Hamiltonian._setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.hamiltonian.SquaredPhi"><code class="docutils literal notranslate"><span class="pre">SquaredPhi</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.hamiltonian.SquaredPhi.__init__"><code class="docutils literal notranslate"><span class="pre">SquaredPhi.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.hamiltonian.SquaredPhi.setup"><code class="docutils literal notranslate"><span class="pre">SquaredPhi.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.hamiltonian.DefaultNoChi"><code class="docutils literal notranslate"><span class="pre">DefaultNoChi</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.hamiltonian.DefaultNoChi.__init__"><code class="docutils literal notranslate"><span class="pre">DefaultNoChi.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.hamiltonian.DefaultNoChi.setup"><code class="docutils literal notranslate"><span class="pre">DefaultNoChi.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.hamiltonian.DefaultWithChi"><code class="docutils literal notranslate"><span class="pre">DefaultWithChi</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.hamiltonian.DefaultWithChi.__init__"><code class="docutils literal notranslate"><span class="pre">DefaultWithChi.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.hamiltonian.DefaultWithChi.setup"><code class="docutils literal notranslate"><span class="pre">DefaultWithChi.setup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-hymd.force">4.4. Force</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.Angle"><code class="docutils literal notranslate"><span class="pre">Angle</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Angle.atom_3"><code class="docutils literal notranslate"><span class="pre">Angle.atom_3</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.Bond"><code class="docutils literal notranslate"><span class="pre">Bond</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Bond.atom_1"><code class="docutils literal notranslate"><span class="pre">Bond.atom_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Bond.atom_2"><code class="docutils literal notranslate"><span class="pre">Bond.atom_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Bond.equilibrium"><code class="docutils literal notranslate"><span class="pre">Bond.equilibrium</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Bond.strength"><code class="docutils literal notranslate"><span class="pre">Bond.strength</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.Chi"><code class="docutils literal notranslate"><span class="pre">Chi</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Chi.atom_1"><code class="docutils literal notranslate"><span class="pre">Chi.atom_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Chi.atom_2"><code class="docutils literal notranslate"><span class="pre">Chi.atom_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Chi.interaction_energy"><code class="docutils literal notranslate"><span class="pre">Chi.interaction_energy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.Dielectric_type"><code class="docutils literal notranslate"><span class="pre">Dielectric_type</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Dielectric_type.atom_1"><code class="docutils literal notranslate"><span class="pre">Dielectric_type.atom_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Dielectric_type.dielectric_value"><code class="docutils literal notranslate"><span class="pre">Dielectric_type.dielectric_value</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.Dihedral"><code class="docutils literal notranslate"><span class="pre">Dihedral</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Dihedral.atom_1"><code class="docutils literal notranslate"><span class="pre">Dihedral.atom_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Dihedral.atom_2"><code class="docutils literal notranslate"><span class="pre">Dihedral.atom_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Dihedral.atom_3"><code class="docutils literal notranslate"><span class="pre">Dihedral.atom_3</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Dihedral.atom_4"><code class="docutils literal notranslate"><span class="pre">Dihedral.atom_4</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Dihedral.coeffs"><code class="docutils literal notranslate"><span class="pre">Dihedral.coeffs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.force.Dihedral.dih_type"><code class="docutils literal notranslate"><span class="pre">Dihedral.dih_type</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.compute_angle_forces__plain"><code class="docutils literal notranslate"><span class="pre">compute_angle_forces__plain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.compute_bond_forces__plain"><code class="docutils literal notranslate"><span class="pre">compute_bond_forces__plain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.compute_dihedral_forces__plain"><code class="docutils literal notranslate"><span class="pre">compute_dihedral_forces__plain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.dipole_forces_redistribution"><code class="docutils literal notranslate"><span class="pre">dipole_forces_redistribution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.find_all_paths"><code class="docutils literal notranslate"><span class="pre">find_all_paths()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.prepare_bonds"><code class="docutils literal notranslate"><span class="pre">prepare_bonds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.prepare_bonds_old"><code class="docutils literal notranslate"><span class="pre">prepare_bonds_old()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.prepare_index_based_bonds"><code class="docutils literal notranslate"><span class="pre">prepare_index_based_bonds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.force.propensity_potential_coeffs"><code class="docutils literal notranslate"><span class="pre">propensity_potential_coeffs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#logger">4.5. Logger</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.logger.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.logger.Logger.setup"><code class="docutils literal notranslate"><span class="pre">Logger.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.logger.MPIFilterRoot"><code class="docutils literal notranslate"><span class="pre">MPIFilterRoot</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.logger.MPIFilterRoot.filter"><code class="docutils literal notranslate"><span class="pre">MPIFilterRoot.filter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.logger.MPIFilterAll"><code class="docutils literal notranslate"><span class="pre">MPIFilterAll</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.logger.MPIFilterAll.filter"><code class="docutils literal notranslate"><span class="pre">MPIFilterAll.filter()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-hymd.input_parser">4.6. Input parser</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.Config"><code class="docutils literal notranslate"><span class="pre">Config</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.a"><code class="docutils literal notranslate"><span class="pre">Config.a</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.angle_bonds"><code class="docutils literal notranslate"><span class="pre">Config.angle_bonds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.barostat"><code class="docutils literal notranslate"><span class="pre">Config.barostat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.barostat_type"><code class="docutils literal notranslate"><span class="pre">Config.barostat_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.bonds"><code class="docutils literal notranslate"><span class="pre">Config.bonds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.box_size"><code class="docutils literal notranslate"><span class="pre">Config.box_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.cancel_com_momentum"><code class="docutils literal notranslate"><span class="pre">Config.cancel_com_momentum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.chi"><code class="docutils literal notranslate"><span class="pre">Config.chi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.conv_crit"><code class="docutils literal notranslate"><span class="pre">Config.conv_crit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.convergence_type"><code class="docutils literal notranslate"><span class="pre">Config.convergence_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.coulomb_constant"><code class="docutils literal notranslate"><span class="pre">Config.coulomb_constant</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.coulombtype"><code class="docutils literal notranslate"><span class="pre">Config.coulombtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.dielectric_const"><code class="docutils literal notranslate"><span class="pre">Config.dielectric_const</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.dielectric_type"><code class="docutils literal notranslate"><span class="pre">Config.dielectric_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.dihedrals"><code class="docutils literal notranslate"><span class="pre">Config.dihedrals</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.domain_decomposition"><code class="docutils literal notranslate"><span class="pre">Config.domain_decomposition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.dtype"><code class="docutils literal notranslate"><span class="pre">Config.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.file_name"><code class="docutils literal notranslate"><span class="pre">Config.file_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.gas_constant"><code class="docutils literal notranslate"><span class="pre">Config.gas_constant</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.hamiltonian"><code class="docutils literal notranslate"><span class="pre">Config.hamiltonian</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.initial_energy"><code class="docutils literal notranslate"><span class="pre">Config.initial_energy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.integrator"><code class="docutils literal notranslate"><span class="pre">Config.integrator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.kappa"><code class="docutils literal notranslate"><span class="pre">Config.kappa</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.m"><code class="docutils literal notranslate"><span class="pre">Config.m</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.mass"><code class="docutils literal notranslate"><span class="pre">Config.mass</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.max_molecule_size"><code class="docutils literal notranslate"><span class="pre">Config.max_molecule_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.mesh_size"><code class="docutils literal notranslate"><span class="pre">Config.mesh_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.n_b"><code class="docutils literal notranslate"><span class="pre">Config.n_b</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.n_flush"><code class="docutils literal notranslate"><span class="pre">Config.n_flush</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.n_particles"><code class="docutils literal notranslate"><span class="pre">Config.n_particles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.n_print"><code class="docutils literal notranslate"><span class="pre">Config.n_print</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.n_steps"><code class="docutils literal notranslate"><span class="pre">Config.n_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.name"><code class="docutils literal notranslate"><span class="pre">Config.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.pol_mixing"><code class="docutils literal notranslate"><span class="pre">Config.pol_mixing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.pressure"><code class="docutils literal notranslate"><span class="pre">Config.pressure</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.respa_inner"><code class="docutils literal notranslate"><span class="pre">Config.respa_inner</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.rho0"><code class="docutils literal notranslate"><span class="pre">Config.rho0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.self_energy"><code class="docutils literal notranslate"><span class="pre">Config.self_energy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.sigma"><code class="docutils literal notranslate"><span class="pre">Config.sigma</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.start_temperature"><code class="docutils literal notranslate"><span class="pre">Config.start_temperature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.tags"><code class="docutils literal notranslate"><span class="pre">Config.tags</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.target_pressure"><code class="docutils literal notranslate"><span class="pre">Config.target_pressure</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.target_temperature"><code class="docutils literal notranslate"><span class="pre">Config.target_temperature</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.tau"><code class="docutils literal notranslate"><span class="pre">Config.tau</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.tau_p"><code class="docutils literal notranslate"><span class="pre">Config.tau_p</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.thermostat_coupling_groups"><code class="docutils literal notranslate"><span class="pre">Config.thermostat_coupling_groups</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.thermostat_work"><code class="docutils literal notranslate"><span class="pre">Config.thermostat_work</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.time_step"><code class="docutils literal notranslate"><span class="pre">Config.time_step</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.input_parser.Config.type_charges"><code class="docutils literal notranslate"><span class="pre">Config.type_charges</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_NPT_conditions"><code class="docutils literal notranslate"><span class="pre">check_NPT_conditions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_angles"><code class="docutils literal notranslate"><span class="pre">check_angles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_bonds"><code class="docutils literal notranslate"><span class="pre">check_bonds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_box_size"><code class="docutils literal notranslate"><span class="pre">check_box_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_cancel_com_momentum"><code class="docutils literal notranslate"><span class="pre">check_cancel_com_momentum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_charges"><code class="docutils literal notranslate"><span class="pre">check_charges()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_charges_types_list"><code class="docutils literal notranslate"><span class="pre">check_charges_types_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_chi"><code class="docutils literal notranslate"><span class="pre">check_chi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_config"><code class="docutils literal notranslate"><span class="pre">check_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_dielectric"><code class="docutils literal notranslate"><span class="pre">check_dielectric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_dihedrals"><code class="docutils literal notranslate"><span class="pre">check_dihedrals()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_domain_decomposition"><code class="docutils literal notranslate"><span class="pre">check_domain_decomposition()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_hamiltonian"><code class="docutils literal notranslate"><span class="pre">check_hamiltonian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_integrator"><code class="docutils literal notranslate"><span class="pre">check_integrator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_m"><code class="docutils literal notranslate"><span class="pre">check_m()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_mass"><code class="docutils literal notranslate"><span class="pre">check_mass()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_max_molecule_size"><code class="docutils literal notranslate"><span class="pre">check_max_molecule_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_n_b"><code class="docutils literal notranslate"><span class="pre">check_n_b()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_n_flush"><code class="docutils literal notranslate"><span class="pre">check_n_flush()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_n_particles"><code class="docutils literal notranslate"><span class="pre">check_n_particles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_n_print"><code class="docutils literal notranslate"><span class="pre">check_n_print()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_name"><code class="docutils literal notranslate"><span class="pre">check_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_start_and_target_temperature"><code class="docutils literal notranslate"><span class="pre">check_start_and_target_temperature()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_tau"><code class="docutils literal notranslate"><span class="pre">check_tau()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.check_thermostat_coupling_groups"><code class="docutils literal notranslate"><span class="pre">check_thermostat_coupling_groups()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.parse_config_toml"><code class="docutils literal notranslate"><span class="pre">parse_config_toml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.read_config_toml"><code class="docutils literal notranslate"><span class="pre">read_config_toml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.input_parser.sort_dielectric_by_type_id"><code class="docutils literal notranslate"><span class="pre">sort_dielectric_by_type_id()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-hymd.field">4.7. Field</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.field.compute_field_and_kinetic_energy"><code class="docutils literal notranslate"><span class="pre">compute_field_and_kinetic_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.field.compute_field_energy_q_GPE"><code class="docutils literal notranslate"><span class="pre">compute_field_energy_q_GPE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.field.compute_field_force"><code class="docutils literal notranslate"><span class="pre">compute_field_force()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.field.compute_self_energy_q"><code class="docutils literal notranslate"><span class="pre">compute_self_energy_q()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.field.domain_decomposition"><code class="docutils literal notranslate"><span class="pre">domain_decomposition()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.field.initialize_pm"><code class="docutils literal notranslate"><span class="pre">initialize_pm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.field.update_field"><code class="docutils literal notranslate"><span class="pre">update_field()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.field.update_field_force_q"><code class="docutils literal notranslate"><span class="pre">update_field_force_q()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.field.update_field_force_q_GPE"><code class="docutils literal notranslate"><span class="pre">update_field_force_q_GPE()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-hymd.file_io">4.8. File input/output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.file_io.OutDataset"><code class="docutils literal notranslate"><span class="pre">OutDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.file_io.OutDataset.close_file"><code class="docutils literal notranslate"><span class="pre">OutDataset.close_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.file_io.OutDataset.flush"><code class="docutils literal notranslate"><span class="pre">OutDataset.flush()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html#hymd.file_io.OutDataset.is_open"><code class="docutils literal notranslate"><span class="pre">OutDataset.is_open()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.file_io.distribute_input"><code class="docutils literal notranslate"><span class="pre">distribute_input()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.file_io.setup_time_dependent_element"><code class="docutils literal notranslate"><span class="pre">setup_time_dependent_element()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.file_io.store_data"><code class="docutils literal notranslate"><span class="pre">store_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html#hymd.file_io.store_static"><code class="docutils literal notranslate"><span class="pre">store_static()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>


    
        <p class="caption">
            <span class="caption-text">
            
                Links
            
            </span>
        </p>
        <ul>
            
                
                    <li class="toctree-l1"><a href="https://pypi.org/project/hymd"><i class="fa fa-cube fa-fw"></i> PyPI</a></li>
                
            
                
                    <li class="toctree-l1"><a href="https://github.com/Cascella-Group-UiO/hymd"><i class="fa fa-code fa-fw"></i> Source code</a></li>
                
            
                
                    <li class="toctree-l1"><a href="https://github.com/Cascella-Group-UiO/hymd/issues/"><i class="fa fa-bug fa-fw"></i> Issue tracker</a></li>
                
            
                
                    <li class="toctree-l1"><a href="about:blank"><i class="fa fa-file-text fa-fw"></i> Citation</a></li>
                
            
        </ul>
    


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hymd</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">1. </span>Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/doc_pages/examples.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples">
<span id="examples-label"></span><h1><span class="section-number">1. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h1>
<p>The following examples are ordered in <em>more or less</em> order of increasing
complexity, adding pieces at each step until we arrive at models for realistic
soft matter systems. All files (input and simulation output trajectories) are
available in the <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial">HyMD-tutorial</a> github repository.</p>
<section id="ideal-gas">
<h2><span class="section-number">1.1. </span>Ideal gas<a class="headerlink" href="#ideal-gas" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/ideal_gas/ideal_gas.png?raw=true"><img alt="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/ideal_gas/ideal_gas.png?raw=true" class="align-right" src="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/ideal_gas/ideal_gas.png?raw=true" style="width: 200px;" /></a>
<p>The simplest possible system is one with no interactions at all—intramolecular
or intermolecular. A minimal configuration file for a non-interacting system
may look like:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><strong>ideal_gas.toml</strong></span><a class="headerlink" href="#id2" title="Permalink to this code"></a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[simulation]</span>
<span class="n">integrator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;velocity-verlet&quot;</span>
<span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w">                      </span><span class="c1"># total simulation steps</span>
<span class="n">n_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w">                       </span><span class="c1"># output trajectory data every n_print steps</span>
<span class="n">time_step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w">                   </span><span class="c1"># time step in ps</span>
<span class="n">box_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0</span><span class="p">]</span><span class="w">         </span><span class="c1"># simulation box size in nm</span>
<span class="n">start_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span><span class="w">            </span><span class="c1"># generate starting temperature in Kelvin</span>
<span class="n">target_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w">         </span><span class="c1"># thermostat temperature in Kelvin</span>
<span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w">                          </span><span class="c1"># thermostat coupling strength in ps</span>
<span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;defaultnochi&quot;</span><span class="w">       </span><span class="c1"># interaction energy functional</span>
<span class="n">kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span><span class="w">                       </span><span class="c1"># compressibility in mol/kJ</span>

<span class="k">[field]</span>
<span class="n">mesh_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w">              </span><span class="c1"># FFT grid size</span>
<span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w">                        </span><span class="c1"># filtering length scale in nm</span>
</pre></div>
</div>
</div>
<p>A simple input structure/topology file <code class="code docutils literal notranslate"><span class="pre">ideal_gas.HDF5</span></code> is available in
the <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/tree/main/ideal_gas">HyMD-tutorial/ideal_gas</a> github repository (along with the code to
generate it). Run the (very) short simulation by</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>hymd<span class="w"> </span>ideal_gas.toml<span class="w"> </span>ideal_gas.HDF5<span class="w"> </span>--disable-field<span class="w">   </span><span class="se">\</span>
<span class="w">                                              </span>--velocity-output<span class="w"> </span><span class="se">\</span>
<span class="w">                                              </span>--force-output
</pre></div>
</div>
<p>with the <code class="code docutils literal notranslate"><span class="pre">--disable-field</span></code> argument to completely turn off all
particle–field interactions. Adding the options to output the velocities and
forces to the trajectory file, enables examining the ballistic motion of the
particles. See the accompanying Jupyter notebook <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/ideal_gas/ideal_gas.ipynb">ideal_gas.ipynb</a> for details.</p>
</section>
<section id="ideal-chains">
<h2><span class="section-number">1.2. </span>Ideal chains<a class="headerlink" href="#ideal-chains" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/ideal_chain/100ps.png?raw=true"><img alt="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/ideal_chain/100ps.png?raw=true" class="align-right" src="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/ideal_chain/100ps.png?raw=true" style="width: 200px;" /></a>
<p>The simplest available interaction is the harmonic two-particle bond (see
<a class="reference internal" href="intramolecular_bonds.html#bonds-label"><span class="std std-ref">Intramolecular bonds</span></a>),</p>
<div class="math notranslate nohighlight">
\[V_2(r) = \frac{k}{2}(r-r_0)^2.\]</div>
<p>Extending the configuration file from the ideal gas case, we need to add a
<code class="code docutils literal notranslate"><span class="pre">bonds</span></code> specification. Note that the <code class="code docutils literal notranslate"><span class="pre">[bonds]</span></code> meta specifier is not
necessary, but may be used to help organise the input file.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><strong>ideal_chain.toml</strong></span><a class="headerlink" href="#id3" title="Permalink to this code"></a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[simulation]</span>
<span class="n">integrator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;velocity-verlet&quot;</span>
<span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10000</span><span class="w">                    </span><span class="c1"># total simulation steps</span>
<span class="n">n_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200</span><span class="w">                      </span><span class="c1"># output trajectory data every n_print steps</span>
<span class="n">time_step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w">                   </span><span class="c1"># time step in ps</span>
<span class="n">box_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">30.0</span><span class="p">,</span><span class="w"> </span><span class="mf">30.0</span><span class="p">,</span><span class="w"> </span><span class="mf">30.0</span><span class="p">]</span><span class="w">      </span><span class="c1"># simulation box size in nm</span>
<span class="n">start_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="w">             </span><span class="c1"># generate starting temperature in Kelvin</span>
<span class="n">target_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span><span class="w">           </span><span class="c1"># thermostat temperature in Kelvin</span>
<span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w">                          </span><span class="c1"># thermostat coupling strength in ps</span>
<span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;defaultnochi&quot;</span><span class="w">       </span><span class="c1"># interaction energy functional</span>
<span class="n">kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span><span class="w">                       </span><span class="c1"># compressibility in mol/kJ</span>

<span class="k">[field]</span>
<span class="n">mesh_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w">              </span><span class="c1"># FFT grid size</span>
<span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w">                        </span><span class="c1"># filtering length scale in nm</span>

<span class="k">[bonds]</span>
<span class="n">bonds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">],</span><span class="w">         </span><span class="c1"># (i name, j name, equilibrium length, strength)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>A simple input structure/topology file <code class="code docutils literal notranslate"><span class="pre">ideal_chain.HDF5</span></code> with a few
coiled up ideal chain polymers is available in the
<a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/tree/main/ideal_chain">HyMD-tutorial/ideal_chain</a> github repository (along with the code to
generate it). Running the simulation with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>hymd<span class="w"> </span>ideal_chain.toml<span class="w"> </span>ideal_chain.HDF5<span class="w"> </span>--disable-field
</pre></div>
</div>
<p>we may examine the radius of gyration of the individual polymer chains. An
example of this is shown in the accompanying Jupyter notebook
<a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/ideal_chain/ideal_chain.ipynb">ideal_chain.ipynb</a>.</p>
</section>
<section id="stiff-rods">
<h2><span class="section-number">1.3. </span>Stiff rods<a class="headerlink" href="#stiff-rods" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/rods/rods.png?raw=true"><img alt="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/rods/rods.png?raw=true" class="align-right" src="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/rods/rods.png?raw=true" style="width: 200px;" /></a>
<p>Having considered two-particle bonds, the next step is three-particle angular
bonds depending on the <code class="code docutils literal notranslate"><span class="pre">i--j--k</span></code> angle <span class="math notranslate nohighlight">\(\theta\)</span> (see
<a class="reference internal" href="intramolecular_bonds.html#bonds-label"><span class="std std-ref">Intramolecular bonds</span></a>),</p>
<div class="math notranslate nohighlight">
\[V_3(\theta) = \frac{k}{2}(\theta-\theta_0)^2.\]</div>
<p>Extending the configuration file from the ideal chain case, we need to add a
<code class="code docutils literal notranslate"><span class="pre">angle_bonds</span></code> specification. Note that the <code class="code docutils literal notranslate"><span class="pre">[bonds]</span></code> meta specifier
is not necessary, but may be used to help organise the input file.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><strong>rods.toml</strong></span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[simulation]</span>
<span class="n">integrator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;velocity-verlet&quot;</span>
<span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10000</span><span class="w">                    </span><span class="c1"># total simulation steps</span>
<span class="n">n_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200</span><span class="w">                      </span><span class="c1"># output trajectory data every n_print steps</span>
<span class="n">time_step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w">                   </span><span class="c1"># time step in ps</span>
<span class="n">box_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">30.0</span><span class="p">,</span><span class="w"> </span><span class="mf">30.0</span><span class="p">,</span><span class="w"> </span><span class="mf">30.0</span><span class="p">]</span><span class="w">      </span><span class="c1"># simulation box size in nm</span>
<span class="n">start_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="w">             </span><span class="c1"># generate starting temperature in Kelvin</span>
<span class="n">target_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span><span class="w">           </span><span class="c1"># thermostat temperature in Kelvin</span>
<span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w">                          </span><span class="c1"># thermostat coupling strength in ps</span>
<span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;defaultnochi&quot;</span><span class="w">       </span><span class="c1"># interaction energy functional</span>
<span class="n">kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span><span class="w">                       </span><span class="c1"># compressibility in mol/kJ</span>

<span class="k">[field]</span>
<span class="n">mesh_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w">              </span><span class="c1"># FFT grid size</span>
<span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w">                        </span><span class="c1"># filtering length scale in nm</span>

<span class="k">[bonds]</span>
<span class="n">bonds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">],</span><span class="w">         </span><span class="c1"># (i name, j name, equilibrium length, strength)</span>
<span class="p">]</span>

<span class="n">angle_bonds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">180.0</span><span class="p">,</span><span class="w"> </span><span class="mf">100.0</span><span class="p">],</span><span class="w">   </span><span class="c1"># (i, j, k, equilibrium angle, strength)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>A simple input structure/topology file <code class="code docutils literal notranslate"><span class="pre">rods.HDF5</span></code> with a few
coiled up polymer chains is available in the <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/tree/main/rods">HyMD-tutorial/rods</a> github
repository (along with the code to generate it). Running the simulation with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>hymd<span class="w"> </span>rods.toml<span class="w"> </span>rods.HDF5<span class="w"> </span>--disable-field
</pre></div>
</div>
<p>the polymer chains extend into rod-like conformations. We may examine the
radius of gyration of the individual polymer chains, and compare it to the
gyration radii of the ideal chain case. An example of this is shown in the
accompanying Jupyter notebook <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/rods/rods.ipynb">rods.ipynb</a>.</p>
</section>
<section id="helixes">
<h2><span class="section-number">1.4. </span>Helixes<a class="headerlink" href="#helixes" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/helixes/helixes.png?raw=true"><img alt="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/helixes/helixes.png?raw=true" class="align-right" src="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/helixes/helixes.png?raw=true" style="width: 200px;" /></a>
<p>Having considered two- and three-particle bonds, the next step is dihedral
four-particle angular bonds, depending on the angle <span class="math notranslate nohighlight">\(\phi\)</span> between the
<code class="code docutils literal notranslate"><span class="pre">i--j--k</span></code> plane and the <code class="code docutils literal notranslate"><span class="pre">j--k--l</span></code> plane (see <a class="reference internal" href="intramolecular_bonds.html#bonds-label"><span class="std std-ref">Intramolecular bonds</span></a>),</p>
<div class="math notranslate nohighlight">
\[V_4(\phi) = \frac{1}{2}\sum_n^M c_n\cos(n\phi+\phi_n).\]</div>
<p>The Cosine series defining the strength and equilibrium conditions of the bond
are given as input in a <code class="code docutils literal notranslate"><span class="pre">dihedrals</span></code> keyword in the configuration file.
The helical dihedral bond is designed for use with peptides and topological
dipole reconstruction, so we need to specify the <code class="code docutils literal notranslate"><span class="pre">dielectric_const</span></code>
keyword even though we are not including electrostatic forces in the current
simulation. Note that the <code class="code docutils literal notranslate"><span class="pre">[bonds]</span></code> meta specifier is not necessary, but
may be used to help organise the input file.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text"><strong>helixes.toml</strong></span><a class="headerlink" href="#id5" title="Permalink to this code"></a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[simulation]</span>
<span class="n">integrator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;velocity-verlet&quot;</span>
<span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10000</span><span class="w">                    </span><span class="c1"># total simulation steps</span>
<span class="n">n_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200</span><span class="w">                      </span><span class="c1"># output trajectory data every n_print steps</span>
<span class="n">time_step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w">                   </span><span class="c1"># time step in ps</span>
<span class="n">box_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">30.0</span><span class="p">,</span><span class="w"> </span><span class="mf">30.0</span><span class="p">,</span><span class="w"> </span><span class="mf">30.0</span><span class="p">]</span><span class="w">      </span><span class="c1"># simulation box size in nm</span>
<span class="n">start_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="w">             </span><span class="c1"># generate starting temperature in Kelvin</span>
<span class="n">target_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span><span class="w">           </span><span class="c1"># thermostat temperature in Kelvin</span>
<span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w">                          </span><span class="c1"># thermostat coupling strength in ps</span>
<span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;defaultnochi&quot;</span><span class="w">       </span><span class="c1"># interaction energy functional</span>
<span class="n">kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span><span class="w">                       </span><span class="c1"># compressibility in mol/kJ</span>
<span class="n">dielectric_const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">15.0</span>

<span class="k">[field]</span>
<span class="n">mesh_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w">              </span><span class="c1"># FFT grid size</span>
<span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w">                        </span><span class="c1"># filtering length scale in nm</span>

<span class="k">[bonds]</span>
<span class="n">bonds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.31</span><span class="p">,</span><span class="w"> </span><span class="mf">10000.0</span><span class="p">],</span><span class="w">       </span><span class="c1"># (i name, j name, equilibrium length, strength)</span>
<span class="p">]</span>

<span class="n">dihedrals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span>
<span class="w">    </span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span>
<span class="w">      </span><span class="p">[</span><span class="mi">-1</span><span class="p">],</span>
<span class="w">      </span><span class="p">[</span><span class="mf">449.08790868</span><span class="p">,</span><span class="w"> </span><span class="mf">610.2408724</span><span class="p">,</span><span class="w"> </span><span class="mf">-544.48626121</span><span class="p">,</span><span class="w"> </span><span class="mf">251.59427866</span><span class="p">,</span><span class="w"> </span><span class="mf">-84.9918564</span><span class="p">],</span>
<span class="w">      </span><span class="p">[</span><span class="mf">0.08</span><span class="p">,</span><span class="w"> </span><span class="mf">0.46</span><span class="p">,</span><span class="w"> </span><span class="mf">1.65</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.96</span><span class="p">,</span><span class="w"> </span><span class="mf">0.38</span><span class="p">],</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<span class="w">  </span><span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>A simple input structure/topology file <code class="code docutils literal notranslate"><span class="pre">helixes.HDF5</span></code> with a few
coiled up polymer chains is available in the <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/tree/main/rods">HyMD-tutorial/rods</a> github
repository (along with the code to generate it). Running the simulation with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>hymd<span class="w"> </span>rods.toml<span class="w"> </span>rods.HDF5<span class="w"> </span>--disable-field
</pre></div>
</div>
<p>the polymer chains extend into helical conformations. An example of this is
shown in the accompanying Jupyter notebook <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/helixes/helixes.ipynb">helixes.ipynb</a>.</p>
</section>
<section id="phase-separation">
<h2><span class="section-number">1.5. </span>Phase separation<a class="headerlink" href="#phase-separation" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/phase_separation/chi=40_final.png?raw=true"><img alt="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/phase_separation/chi=40_final.png?raw=true" class="align-right" src="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/phase_separation/chi=40_final.png?raw=true" style="width: 200px;" /></a>
<p>The simplest field interaction available in HyMD is the interaction between two
monoatomic particles of types <code class="code docutils literal notranslate"><span class="pre">A</span></code> and <code class="code docutils literal notranslate"><span class="pre">B</span></code>. Using the Hamiltonian</p>
<div class="math notranslate nohighlight">
\[\mathcal{H}=H_0+W\]</div>
<p>with <span class="math notranslate nohighlight">\(\tilde\chi\)</span>–dependent interactions defined by (specified in the
configuration file by <code class="code docutils literal notranslate"><span class="pre">hamiltonian</span> <span class="pre">=</span> <span class="pre">DefaultWithChi</span></code>):</p>
<div class="math notranslate nohighlight">
\[W=\frac{1}{\phi_0}\int\mathrm{d}\mathbf{r}\tilde\chi_{\text{A}-\text{B}}\tilde\phi_\text{A}(\mathbf{r})\tilde\phi_\text{B}(\mathbf{r}) + \frac{1}{2\kappa}\left(\tilde\phi_\text{A}(\mathbf{r})+\tilde\phi_\text{B}\mathbf{r}-\phi_0\right)^2.\]</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text"><strong>phase_separation.toml</strong></span><a class="headerlink" href="#id6" title="Permalink to this code"></a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[simulation]</span>
<span class="n">integrator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;velocity-verlet&quot;</span>
<span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10000</span><span class="w">                    </span><span class="c1"># total simulation steps</span>
<span class="n">n_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span><span class="w">                     </span><span class="c1"># output trajectory data every n_print steps</span>
<span class="n">time_step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w">                   </span><span class="c1"># time step in ps</span>
<span class="n">box_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0</span><span class="p">]</span><span class="w">         </span><span class="c1"># simulation box size in nm</span>
<span class="n">start_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span><span class="w">            </span><span class="c1"># generate starting temperature in Kelvin</span>
<span class="n">target_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span><span class="w">           </span><span class="c1"># thermostat temperature in Kelvin</span>
<span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w">                          </span><span class="c1"># thermostat coupling strength in ps</span>
<span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;defaultwithchi&quot;</span><span class="w">     </span><span class="c1"># interaction energy functional</span>

<span class="k">[field]</span>
<span class="n">mesh_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">]</span><span class="w">           </span><span class="c1"># FFT grid size</span>
<span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w">                        </span><span class="c1"># filtering length scale in nm</span>
<span class="n">kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span><span class="w">                       </span><span class="c1"># compressibility in mol/kJ</span>
<span class="n">chi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0</span><span class="p">],</span><span class="w">                 </span><span class="c1"># (name i, name j, strength)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>A simple input structure/topology file <code class="code docutils literal notranslate"><span class="pre">phase_separation.HDF5</span></code> containing
an equal number of <code class="code docutils literal notranslate"><span class="pre">A</span></code> type and <code class="code docutils literal notranslate"><span class="pre">B</span></code> type particles is available in
the <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/tree/main/phase_separation">HyMD-tutorial/phase_separation</a> github repository (along with the code to
generate it). Running the simulation with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>hymd<span class="w"> </span>phase_separation.toml<span class="w"> </span>phase_separation.HDF5
</pre></div>
</div>
<p>we may examine the resulting trajectory. In the case of a low interaction
strength <span class="math notranslate nohighlight">\(\tilde\chi\)</span> of <code class="code docutils literal notranslate"><span class="pre">5.0</span></code> (below the critical value of
separation) the system remains mixed. However, raising the interaction strength
to <code class="code docutils literal notranslate"><span class="pre">40.0</span></code> (well above the critical value) yields a phase separated system.
This may be elucidated by considering the radial distribution function in each
case. An example of this is shown in the accompanying Jupyter notebook
<a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/phase_separation/phase_separation.ipynb">phase_separation.ipynb</a>.</p>
</section>
<section id="diblock-copolymers">
<h2><span class="section-number">1.6. </span>Diblock copolymers<a class="headerlink" href="#diblock-copolymers" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/copolymer/copolymer_final.png?raw=true"><img alt="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/copolymer/copolymer_final.png?raw=true" class="align-right" src="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/copolymer/copolymer_final.png?raw=true" style="width: 200px;" /></a>
<p>Having introduced particle–field interactions, we may now combine bonded and
field terms and make a model of diblock copolymers phase separating under
positive <span class="math notranslate nohighlight">\(\tilde\chi\)</span>–interactions. This simple model contains two- and
three-particle harmonic bonds as well. With the combination of bonded and field
interactions, we may also introduce the rRESPA multiple time step integator with
the <code class="code docutils literal notranslate"><span class="pre">integrator</span> <span class="pre">=</span> <span class="pre">&quot;respa&quot;</span></code> keyword. Putting the pieces together, the
configuration file may look like the following:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><strong>copolymer.toml</strong></span><a class="headerlink" href="#id7" title="Permalink to this code"></a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[simulation]</span>
<span class="n">integrator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;respa&quot;</span>
<span class="n">respa_inner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span>
<span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span><span class="w">                     </span><span class="c1"># total simulation steps</span>
<span class="n">n_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span><span class="w">                     </span><span class="c1"># output trajectory data every n_print steps</span>
<span class="n">time_step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="w">                   </span><span class="c1"># time step in ps</span>
<span class="n">box_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">10.0</span><span class="p">,</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span><span class="w"> </span><span class="mf">10.0</span><span class="p">]</span><span class="w">      </span><span class="c1"># simulation box size in nm</span>
<span class="n">start_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="w">             </span><span class="c1"># generate starting temperature in Kelvin</span>
<span class="n">target_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">300</span><span class="w">           </span><span class="c1"># thermostat temperature in Kelvin</span>
<span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w">                          </span><span class="c1"># thermostat coupling strength in ps</span>
<span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;defaultwithchi&quot;</span><span class="w">     </span><span class="c1"># interaction energy functional</span>
<span class="n">kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span><span class="w">                       </span><span class="c1"># compressibility in mol/kJ</span>

<span class="k">[field]</span>
<span class="n">mesh_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">]</span><span class="w">           </span><span class="c1"># FFT grid size</span>
<span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="w">                        </span><span class="c1"># filtering length scale in nm</span>
<span class="n">chi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">30.0</span><span class="p">],</span><span class="w">                </span><span class="c1"># (i, j, strength)</span>
<span class="p">]</span>

<span class="k">[bonds]</span>
<span class="n">bonds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="mf">1500.0</span><span class="p">],</span><span class="w">        </span><span class="c1"># (i, j, equilibrium length, strength)</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="mf">1500.0</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="mf">1500.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">angle_bonds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">180.0</span><span class="p">,</span><span class="w"> </span><span class="mf">25.0</span><span class="p">],</span><span class="w">    </span><span class="c1"># (i, j, k, equilibrium angle, strength)</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">180.0</span><span class="p">,</span><span class="w"> </span><span class="mf">25.0</span><span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>A simple input structure/topology file <code class="code docutils literal notranslate"><span class="pre">copolymer.HDF5</span></code> with a few
coiled up polymer chains is available in the <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/tree/main/copolymer">HyMD-tutorial/copolymer</a> github
repository (along with the code to generate it). Each polymer chain is 20
particles long, with ten <code class="code docutils literal notranslate"><span class="pre">A</span></code> followed by ten <code class="code docutils literal notranslate"><span class="pre">B</span></code> type particles.
Running the simulation with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>hymd<span class="w"> </span>copolymer.toml<span class="w"> </span>copolymer.HDF5
</pre></div>
</div>
<p>the polymer chains extend into rod-like conformations in a phase-separating
manner. An example of this is shown in the accompanying Jupyter notebook
<a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/copolymer/copolymer.ipynb">copolymer.ipynb</a>.</p>
</section>
<section id="lipid-bilayer-self-assembly">
<h2><span class="section-number">1.7. </span>Lipid bilayer self-assembly<a class="headerlink" href="#lipid-bilayer-self-assembly" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/lipid_self_assembly/bilayer.png?raw=true"><img alt="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/lipid_self_assembly/bilayer.png?raw=true" class="align-right" src="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/lipid_self_assembly/bilayer.png?raw=true" style="width: 300px;" /></a>
<p>Putting together the same pieces as in the diblock copolymer case, we may setup
a model of a phospholipid (DPPC) which self-assembles into a bilayer
conformation. The same ingredients (as in the copolymer system) are present in
the configuration file; harmonic bonds, angular bonds, and field–particle
interactions. In this case, we couple a different thermostat to the solvent and
the lipids via the <code class="code docutils literal notranslate"><span class="pre">thermostat_coupling_groups</span></code> keyword. With parameters
optimised in <span id="id1">[<a class="reference internal" href="../index.html#id17" title="Morten Ledum, SigbjÃ¸rn LÃ¸land Bore, and Michele Cascella. Automated determination of hybrid particle-field parameters by machine learning. Mol. Phys., 118(19-20):e1785571, 2020. doi:10.1080/00268976.2020.1785571.">Ledum <em>et al.</em>, 2020</a>]</span>, the configuration file looks like:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text"><strong>lipid_self_assembly.toml</strong></span><a class="headerlink" href="#id8" title="Permalink to this code"></a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[simulation]</span>
<span class="n">integrator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;respa&quot;</span>
<span class="n">respa_inner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span>
<span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3000</span>
<span class="n">n_print</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200</span>
<span class="n">n_flush</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="n">time_step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span>
<span class="n">box_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">9.96924</span><span class="p">,</span><span class="w"> </span><span class="mf">9.96924</span><span class="p">,</span><span class="w"> </span><span class="mf">10.03970</span><span class="p">]</span>
<span class="n">start_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">323</span>
<span class="n">target_temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">323</span>
<span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span>
<span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;defaultwithchi&quot;</span>
<span class="n">kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span>
<span class="n">domain_decomposition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10001</span>
<span class="n">cancel_com_momentum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="n">max_molecule_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span>
<span class="n">thermostat_coupling_groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">],</span>
<span class="p">]</span>

<span class="k">[field]</span>
<span class="n">mesh_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">]</span>
<span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="n">chi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">42.24</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">10.47</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">-3.77</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">4.53</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">-9.34</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">8.04</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.97</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">14.72</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.51</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">13.56</span><span class="p">],</span>
<span class="p">]</span>

<span class="k">[bonds]</span>
<span class="n">bonds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.47</span><span class="p">,</span><span class="w"> </span><span class="mf">1250.0</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.47</span><span class="p">,</span><span class="w"> </span><span class="mf">1250.0</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.37</span><span class="p">,</span><span class="w"> </span><span class="mf">1250.0</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.47</span><span class="p">,</span><span class="w"> </span><span class="mf">1250.0</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">0.47</span><span class="p">,</span><span class="w"> </span><span class="mf">1250.0</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">angle_bonds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">120.0</span><span class="p">,</span><span class="w"> </span><span class="mf">25.0</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">180.0</span><span class="p">,</span><span class="w"> </span><span class="mf">25.0</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">180.0</span><span class="p">,</span><span class="w"> </span><span class="mf">25.0</span><span class="p">],</span>
<span class="w">  </span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">180.0</span><span class="p">,</span><span class="w"> </span><span class="mf">25.0</span><span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>A randomly mixed input structure/topology file
<code class="code docutils literal notranslate"><span class="pre">lipid_self_assembly.HDF5</span></code> with a few hundred lipids in a roughy
<code class="code docutils literal notranslate"><span class="pre">10</span> <span class="pre">x</span> <span class="pre">10</span> <span class="pre">x</span> <span class="pre">10nm</span></code> box is available in the
<a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/tree/main/lipid_self_assembly">HyMD-tutorial/lipid_self_assembly</a> github repository. The simulation box was
previously equilibrated in the Martini model before subsequent mixing of the
contents. Running the simulation</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>hymd<span class="w"> </span>lipid_self_assembly.toml<span class="w"> </span>lipid_self_assembly.HDF5
</pre></div>
</div>
<p>we can observe spontaneous aggregation into a bilayer conformation in the
sub-nanosecond regime. An example of this is shown in the accompanying Jupyter
notebook <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/lipid_self_assembly/lipid_self_assembly.ipynb">lipid_self_assembly.ipynb</a>.</p>
</section>
<section id="peptide-in-lipid-bilayer">
<h2><span class="section-number">1.8. </span>Peptide in lipid bilayer<a class="headerlink" href="#peptide-in-lipid-bilayer" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/peptide/peptide.png?raw=true"><img alt="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/peptide/peptide.png?raw=true" class="align-right" src="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/peptide/peptide.png?raw=true" style="width: 300px;" /></a>
<p>Next, we combine the dihedral helical propensity and the lipid model, and model
a single homopolypeptide consisting of alanine amino acids embedded inside a
DOPC phospholipid bilayer.</p>
<p>The <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/peptide/peptide.toml">configuration file</a> is available in the <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/tree/main/peptide">HyMD-tutorial/peptide</a> github
repository (omitted here for brevity).</p>
<p>A pre-equilibrated input structure/topology file <code class="code docutils literal notranslate"><span class="pre">peptide.HDF5</span></code> with a
few hundred lipids in a roughy <code class="code docutils literal notranslate"><span class="pre">20</span> <span class="pre">x</span> <span class="pre">20</span> <span class="pre">x</span> <span class="pre">20nm</span></code> box is available in the
<a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/tree/main/peptide">HyMD-tutorial/peptide</a> github repository. Running the simulation</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>hymd<span class="w"> </span>peptide.toml<span class="w"> </span>peptide.HDF5
</pre></div>
</div>
<p>we observe the peptide embedded laterally in the membrane in a stable
configuration.  An example of this is shown in the accompanying Jupyter
notebook <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/peptide/peptide.ipynb">peptide.ipynb</a>.</p>
</section>
<section id="sds">
<h2><span class="section-number">1.9. </span>SDS<a class="headerlink" href="#sds" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/sds/oblate.png?raw=true"><img alt="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/sds/oblate.png?raw=true" class="align-right" src="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/sds/oblate.png?raw=true" style="width: 300px;" /></a>
<p>The last part we introduce is explicit electrostatic interactions through
particle–mesh Ewald. Enabling the electrostatic calculations is done via the
<code class="code docutils literal notranslate"><span class="pre">coulombtype</span></code> keyword. <code class="code docutils literal notranslate"><span class="pre">&quot;PIC_Spectral&quot;</span></code> is the only supported
value in the released version of the code (more general variants are in
development). We specify the relative dielectric constant of the simulation
medium via the <code class="code docutils literal notranslate"><span class="pre">dielectric_const</span></code> keyword. As an example system, we use
a model for sodium dodecyl sulfate (SDS), consiting of short four-particle
chains with the head group carrying charge of negative one. We add sodium
counter-ions to ensure stability of the Ewald scheme by neutralising the total
system charge.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text"><strong>sds.toml</strong></span><a class="headerlink" href="#id9" title="Permalink to this code"></a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span>[simulation]
integrator = &quot;respa&quot;
respa_inner = 10
n_steps = 3000
n_print = 1500
n_flush =
time_step = 0.01
box_size = [8.3, 8.3, 8.3]
start_temperature = 298
target_temperature = 298
tau = 0.1
hamiltonian = &quot;defaultwithchi&quot;
kappa = 0.1
domain_decomposition = 10000
cancel_com_momentum = true
max_molecule_size = 5
thermostat_coupling_groups = [
  [&quot;S&quot;, &quot;C&quot;],
  [&quot;W&quot;, &quot;Na&quot;],
]
dielectric_const = 45.0              # dielectric constant for the simulation medium
coulombtype = &quot;PIC_Spectral&quot;         # particle in cloud, spectral method

[field]
mesh_size = [64, 64, 64]
sigma = 0.5
chi = [
  [&quot;S&quot;, &quot;C&quot;,  13.50],
  [&quot;S&quot;, &quot;Na&quot;,  0.00],
  [&quot;S&quot;, &quot;W&quot;,  -3.60],
  [&quot;C&quot;, &quot;Na&quot;, 13.50],
  [&quot;C&quot;, &quot;W&quot;,  33.75],
  [&quot;W&quot;, &quot;Na&quot;,  0.00],
]

[bonds]
bonds = [
  [&quot;S&quot;,   &quot;C&quot;,   0.50, 1250.0],
  [&quot;C&quot;,   &quot;C&quot;,   0.50, 1250.0],
]
angle_bonds = [
  [&quot;S&quot;, &quot;C&quot;, &quot;C&quot;, 170.0, 25.0],
  [&quot;C&quot;, &quot;C&quot;, &quot;C&quot;, 180.0, 25.0],
]
</pre></div>
</div>
</div>
<p>An input structure/topology file <code class="code docutils literal notranslate"><span class="pre">sds.HDF5</span></code> with a couple thousand
randomly dispersed SDS chains is available in the <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/tree/main/sds">HyMD-tutorial/sds</a> github
repository (along with the code to generate it). Note that the charges are
specified in the structure/topology file through a <code class="code docutils literal notranslate"><span class="pre">/charge</span></code> dataset.
Running the simulation with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>hymd<span class="w"> </span>sds.toml<span class="w"> </span>sds.HDF5
</pre></div>
</div>
<p>we observe the aggregation of the SDS into micellular structures—first oblate
spheroid shaped and later fully spherical. An example of this is shown in the
accompanying Jupyter notebook <a class="reference external" href="https://github.com/Cascella-Group-UiO/HyMD-tutorial/blob/main/sds/sds.ipynb">sds.ipynb</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="constants_and_units.html" class="btn btn-neutral float-left" title="6. Constants and Units" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="theory.html" class="btn btn-neutral float-right" title="1. Theory" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Morten Ledum, Xinmeng Li, Samiran Sen, Manuel Carrer, Sigbjørn Løland Bore.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v1.0.8
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Releases</dt>
      <dd><a href="../../v1.0.1/doc_pages/examples.html">v1.0.1</a></dd>
      <dd><a href="../../v1.0.2/doc_pages/examples.html">v1.0.2</a></dd>
      <dd><a href="../../v1.0.3/doc_pages/examples.html">v1.0.3</a></dd>
      <dd><a href="../../v1.0.4/doc_pages/examples.html">v1.0.4</a></dd>
      <dd><a href="../../v1.0.5/doc_pages/examples.html">v1.0.5</a></dd>
      <dd><a href="../../v1.0.6/doc_pages/examples.html">v1.0.6</a></dd>
      <dd><a href="../../v1.0.7/doc_pages/examples.html">v1.0.7</a></dd>
      <dd><a href="examples.html">v1.0.8</a></dd>
      <dd><a href="../../v1.0.9/doc_pages/examples.html">v1.0.9</a></dd>
      <dd><a href="../../v2.0.0/doc_pages/examples.html">v2.0.0</a></dd>
      <dd><a href="../../v2.0.1/doc_pages/examples.html">v2.0.1</a></dd>
      <dd><a href="../../v2.0.2/doc_pages/examples.html">v2.0.2</a></dd>
      <dd><a href="../../v2.1.0/doc_pages/examples.html">v2.1.0</a></dd>
      <dd><a href="../../v2.2.0/doc_pages/examples.html">v2.2.0</a></dd>
    </dl>
    <dl>
      <dt>Development</dt>
      <dd><a href="../../main/doc_pages/examples.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>